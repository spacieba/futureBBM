<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GP Basketball Manager</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* === TH√àMES DYNAMIQUES PAR FRANCHISE === */
        
        :root {
            --transition-theme: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* === TH√àME MINOTAURS === */
        .theme-minotaurs {
            --primary-color: #DC2626;
            --secondary-color: #991B1B;
            --accent-color: #FEF3C7;
            --bg-gradient-1: #1F1111;
            --bg-gradient-2: #3F1515;
            --text-primary: #FFFFFF;
            --text-secondary: #FCA5A5;
            --glow-color: rgba(220, 38, 38, 0.6);
        }

        .theme-minotaurs body {
            background: linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 50%, #000000 100%);
            background-attachment: fixed;
            position: relative;
        }

        .theme-minotaurs::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(220, 38, 38, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(153, 27, 27, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
            opacity: 0.7;
        }

        /* === TH√àME KRAKENS === */
        .theme-krakens {
            --primary-color: #0891B2;
            --secondary-color: #0C4A6E;
            --accent-color: #67E8F9;
            --bg-gradient-1: #042F3E;
            --bg-gradient-2: #064E6B;
            --text-primary: #FFFFFF;
            --text-secondary: #7DD3C0;
            --glow-color: rgba(8, 145, 178, 0.6);
        }

        .theme-krakens body {
            background: linear-gradient(180deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 50%, #001E2E 100%);
            background-attachment: fixed;
            position: relative;
            overflow-x: hidden;
        }

        .theme-krakens::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: -100%;
            width: 300%;
            height: 150px;
            background: linear-gradient(90deg,
                transparent,
                rgba(103, 232, 249, 0.05),
                transparent,
                rgba(8, 145, 178, 0.05)
            );
            animation: wave 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
            opacity: 0.8;
        }

        @keyframes wave {
            0% { transform: translateX(0) translateZ(0) scaleY(1); }
            50% { transform: translateX(-25%) translateZ(0) scaleY(0.9); }
            100% { transform: translateX(-50%) translateZ(0) scaleY(1); }
        }

        /* === TH√àME PHOENIX === */
        .theme-phoenix {
            --primary-color: #7C3AED;
            --secondary-color: #5B21B6;
            --accent-color: #DDD6FE;
            --bg-gradient-1: #1E1B4B;
            --bg-gradient-2: #312E81;
            --text-primary: #FFFFFF;
            --text-secondary: #DDD6FE;
            --glow-color: rgba(124, 58, 237, 0.6);
        }

        .theme-phoenix body {
            background: 
                radial-gradient(ellipse at top, var(--bg-gradient-2), transparent 60%),
                linear-gradient(180deg, var(--bg-gradient-1) 0%, #1F0F00 100%);
            background-attachment: fixed;
            position: relative;
        }

        .theme-phoenix::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            right: -50%;
            bottom: -50%;
            background: radial-gradient(circle, rgba(252, 211, 77, 0.06) 1px, transparent 1px);
            background-size: 60px 60px;
            animation: rise 40s linear infinite;
            pointer-events: none;
            z-index: 1;
            opacity: 0.7;
        }

        @keyframes rise {
            0% { transform: translateY(100%) rotate(0deg); }
            100% { transform: translateY(-100%) rotate(180deg); }
        }

        /* === TH√àME WEREWOLVES === */
        .theme-werewolves {
            --primary-color: #16A34A;
            --secondary-color: #15803D;
            --accent-color: #BBF7D0;
            --bg-gradient-1: #0A1F0F;
            --bg-gradient-2: #14532D;
            --text-primary: #FFFFFF;
            --text-secondary: #86EFAC;
            --glow-color: rgba(22, 163, 74, 0.6);
        }

        .theme-werewolves body {
            background: 
                linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 50%, #052E16 100%);
            background-attachment: fixed;
            position: relative;
        }

        .theme-werewolves::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(187, 247, 208, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(22, 163, 74, 0.08) 0%, transparent 50%);
            opacity: 0.6;
            pointer-events: none;
            z-index: 1;
        }
        

        /* === NAVIGATION MOBILE AM√âLIOR√âE === */
        
        .mobile-nav {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          background: rgba(0, 0, 0, 0.95);
          backdrop-filter: blur(20px);
          -webkit-backdrop-filter: blur(20px);
          border-top: 1px solid rgba(255, 255, 255, 0.2);
          padding: 8px 4px;
          padding-bottom: env(safe-area-inset-bottom, 8px);
          z-index: 9999;
          display: none;
          box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }
        
        @media (max-width: 768px) {
          .mobile-nav {
            display: flex;
            justify-content: space-around;
          }
          
          body {
            padding-bottom: calc(60px + env(safe-area-inset-bottom));
          }
          
          /* Ajustements pour √©viter que le contenu soit cach√© */
          .min-h-screen {
            min-height: calc(100vh - 60px - env(safe-area-inset-bottom));
          }
        }
        
        .mobile-nav-button {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 10px 8px;
          border-radius: 12px;
          transition: all 0.3s ease;
          text-decoration: none;
          color: rgba(255, 255, 255, 0.6);
          min-width: 60px;
          min-height: 50px;
          position: relative;
        }
        
        .mobile-nav-button:active {
          transform: scale(0.95);
          background: rgba(255, 255, 255, 0.2);
        }
        
        .mobile-nav-button.active {
          color: white;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(139, 92, 246, 0.3));
        }
        
        .mobile-nav-button.active::before {
          content: '';
          position: absolute;
          top: -2px;
          left: 50%;
          transform: translateX(-50%);
          width: 30px;
          height: 3px;
          background: linear-gradient(90deg, #818cf8, #a78bfa);
          border-radius: 2px;
        }
        
        .mobile-nav-icon {
          font-size: 24px;
          margin-bottom: 4px;
          transition: transform 0.3s ease;
        }
        
        .mobile-nav-button:active .mobile-nav-icon {
          transform: scale(1.2);
        }
        
        .mobile-nav-text {
          font-size: 11px;
          font-weight: 600;
          letter-spacing: 0.3px;
        }
        
        /* Am√©lioration des zones tactiles sur mobile */
        @media (max-width: 768px) {
          button, .touch-target {
            min-height: 44px;
            min-width: 44px;
          }
          
          /* Espacement pour les petits boutons */
          .gap-3 {
            gap: 0.75rem;
          }
        }

        /* === TABLEAUX RESPONSIFS === */
        @media (max-width: 768px) {
          .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 0 -1rem;
            padding: 0 1rem;
          }
          
          .table-container::-webkit-scrollbar {
            height: 6px;
          }
          
          .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
          }
          
          .table-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
          }
          
          table {
            min-width: 500px;
          }
        }
        
        /* === MODALES RESPONSIVES === */
        @media (max-width: 768px) {
          .modal-content {
            max-height: 85vh;
            overflow-y: auto;
            margin: 1rem;
            border-radius: 1rem;
          }
          
          .modal-backdrop {
            padding: 0;
          }
        }
        
        /* === GRAPHIQUES RESPONSIFS === */
        @media (max-width: 768px) {
          .chart-container {
            position: relative;
            height: 250px !important;
            width: 100% !important;
          }
          
          canvas {
            max-height: 250px !important;
          }
        }

        /* === STYLES COMMUNS ADAPT√âS AUX TH√àMES === */
        
        /* Cartes avec effet glassmorphism adapt√© au th√®me */
        .theme-card {
            background: linear-gradient(135deg, 
                rgba(var(--card-rgb, 255, 255, 255), 0.1),
                rgba(var(--card-rgb, 255, 255, 255), 0.05)
            );
            backdrop-filter: blur(10px);
            border: 1px solid rgba(var(--card-rgb, 255, 255, 255), 0.2);
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.37),
                inset 0 0 12px var(--glow-color);
            transition: var(--transition-theme);
            position: relative;
            z-index: 10;
        }

        .theme-card:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: 
                0 12px 40px 0 var(--glow-color),
                inset 0 0 20px var(--glow-color);
        }
        
        /* === PERSONNALISATIONS AVANC√âES PAR FRANCHISE === */
        
        /* Minotaurs - Th√®me Guerre/Force */
        .theme-minotaurs .theme-card {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.15), rgba(153, 27, 27, 0.1));
            border: 1px solid rgba(220, 38, 38, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.4),
                inset 0 0 15px rgba(220, 38, 38, 0.2),
                0 0 30px rgba(220, 38, 38, 0.15);
        }
        
        .theme-minotaurs .theme-text-glow {
            text-shadow: 
                0 0 15px rgba(220, 38, 38, 0.9),
                0 0 30px rgba(153, 27, 27, 0.6),
                0 2px 4px rgba(0, 0, 0, 0.8);
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .theme-minotaurs .theme-button {
            background: linear-gradient(135deg, #DC2626, #991B1B, #7F1D1D);
            box-shadow: 
                0 6px 20px rgba(220, 38, 38, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 800;
        }
        
        /* Krakens - Th√®me Oc√©an/Mystique */
        .theme-krakens .theme-card {
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.15), rgba(12, 74, 110, 0.1));
            border: 1px solid rgba(8, 145, 178, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(0, 30, 46, 0.5),
                inset 0 0 15px rgba(8, 145, 178, 0.2),
                0 0 40px rgba(103, 232, 249, 0.1);
        }
        
        .theme-krakens .theme-text-glow {
            text-shadow: 
                0 0 20px rgba(8, 145, 178, 0.9),
                0 0 40px rgba(103, 232, 249, 0.5),
                0 2px 8px rgba(0, 30, 46, 0.8);
        }
        
        .theme-krakens .theme-button {
            background: linear-gradient(135deg, #0891B2, #0C4A6E, #164E63);
            box-shadow: 
                0 8px 25px rgba(8, 145, 178, 0.3),
                inset 0 1px 0 rgba(103, 232, 249, 0.3);
        }
        
        /* Phoenix - Th√®me Magie/Myst√®re */
        .theme-phoenix .theme-card {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(91, 33, 182, 0.1));
            border: 1px solid rgba(124, 58, 237, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(30, 27, 75, 0.5),
                inset 0 0 15px rgba(124, 58, 237, 0.2),
                0 0 50px rgba(221, 214, 254, 0.1);
        }
        
        .theme-phoenix .theme-text-glow {
            text-shadow: 
                0 0 25px rgba(124, 58, 237, 0.9),
                0 0 50px rgba(221, 214, 254, 0.6),
                0 2px 6px rgba(30, 27, 75, 0.8);
            font-style: italic;
            font-weight: 600;
        }
        
        .theme-phoenix .theme-button {
            background: linear-gradient(135deg, #7C3AED, #5B21B6, #4C1D95);
            box-shadow: 
                0 10px 30px rgba(124, 58, 237, 0.4),
                inset 0 1px 0 rgba(221, 214, 254, 0.3);
        }
        
        /* Werewolves - Th√®me Nature/Sauvage */
        .theme-werewolves .theme-card {
            background: linear-gradient(135deg, rgba(22, 163, 74, 0.15), rgba(21, 128, 61, 0.1));
            border: 1px solid rgba(22, 163, 74, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(5, 46, 22, 0.5),
                inset 0 0 15px rgba(22, 163, 74, 0.2),
                0 0 35px rgba(187, 247, 208, 0.1);
        }
        
        .theme-werewolves .theme-text-glow {
            text-shadow: 
                0 0 18px rgba(22, 163, 74, 0.9),
                0 0 35px rgba(187, 247, 208, 0.5),
                0 2px 5px rgba(5, 46, 22, 0.8);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .theme-werewolves .theme-button {
            background: linear-gradient(135deg, #16A34A, #15803D, #166534);
            box-shadow: 
                0 7px 22px rgba(22, 163, 74, 0.3),
                inset 0 1px 0 rgba(187, 247, 208, 0.2);
        }
        
        
        /* === INSCRIPTION DE TEMPLE (MAXIMES DE FRANCHISE) === */
        .temple-inscription {
            position: relative;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.5));
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .temple-inscription::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--primary-color, #FFD700), 
                var(--secondary-color, #FFA500), 
                var(--accent-color, #FF6347),
                var(--primary-color, #FFD700)
            );
            border-radius: 15px;
            z-index: -1;
            opacity: 0.3;
            animation: temple-glow 3s ease-in-out infinite alternate;
        }
        
        @keyframes temple-glow {
            0% { opacity: 0.2; }
            100% { opacity: 0.5; }
        }
        
        .temple-inscription .maxime-english {
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem;
            font-weight: bold;
            font-style: italic;
            color: #FFD700;
            text-shadow: 
                0 0 10px currentColor,
                0 0 20px currentColor,
                0 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: 1px;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        
        .temple-inscription .maxime-french {
            font-family: 'Georgia', serif;
            font-size: 0.9rem;
            font-style: italic;
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
            letter-spacing: 0.5px;
        }
        
        .temple-inscription .temple-ornament {
            position: absolute;
            top: 10px;
            font-size: 1.5rem;
            opacity: 0.4;
        }
        
        .temple-inscription .temple-ornament.left {
            left: 15px;
        }
        
        .temple-inscription .temple-ornament.right {
            right: 15px;
            transform: scaleX(-1);
        }
        
        /* === EFFETS SP√âCIAUX DE BACKGROUND PAR FRANCHISE === */
        
        /* Minotaurs - Particules de lave subtiles */
        .theme-minotaurs::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(220, 38, 38, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(153, 27, 27, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Krakens - Vagues oc√©aniques */
        .theme-krakens::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(0deg, rgba(8, 145, 178, 0.08) 0%, transparent 100%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Phoenix - Aura mystique */
        .theme-phoenix::after {
            content: '';
            position: fixed;
            top: 50%;
            left: 50%;
            width: 80%;
            height: 80%;
            background: radial-gradient(ellipse at center, rgba(124, 58, 237, 0.08) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Werewolves - Brume de for√™t */
        .theme-werewolves::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 30% 40%, rgba(22, 163, 74, 0.06) 0%, transparent 60%),
                radial-gradient(circle at 70% 60%, rgba(21, 128, 61, 0.06) 0%, transparent 60%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Non-Draft√©s - Th√®me neutre et prometteur */
        .theme-undrafted {
            --primary-color: #6B7280;
            --secondary-color: #4B5563;
            --accent-color: #F3F4F6;
            --bg-gradient-1: #1F2937;
            --bg-gradient-2: #374151;
            --text-primary: #FFFFFF;
            --text-secondary: #D1D5DB;
            --glow-color: rgba(107, 114, 128, 0.5);
        }
        
        .theme-undrafted::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 50% 50%, rgba(107, 114, 128, 0.05) 0%, transparent 70%);
            pointer-events: none;
            z-index: 1;
        }
        
        .theme-undrafted .theme-card {
            background: linear-gradient(135deg, rgba(107, 114, 128, 0.15), rgba(75, 85, 99, 0.1));
            border: 1px solid rgba(107, 114, 128, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(31, 41, 55, 0.5),
                inset 0 0 15px rgba(107, 114, 128, 0.2),
                0 0 30px rgba(209, 213, 219, 0.1);
        }
        
        .theme-undrafted .theme-button {
            background: linear-gradient(135deg, #6B7280, #4B5563, #374151);
            box-shadow: 
                0 6px 20px rgba(107, 114, 128, 0.3),
                inset 0 1px 0 rgba(243, 244, 246, 0.2);
        }
        
        .theme-undrafted h1 {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            letter-spacing: 0.5px;
        }
        
        /* === PERSONNALISATION DES TITRES === */
        
        /* Titres principaux avec polices th√©matiques */
        .theme-minotaurs h1 {
            font-family: 'Georgia', 'Times New Roman', serif;
            text-transform: uppercase;
        }
        
        .theme-krakens h1 {
            font-family: 'Trebuchet MS', 'Segoe UI', sans-serif;
            letter-spacing: 0.5px;
        }
        
        .theme-phoenix h1 {
            font-family: 'Book Antiqua', 'Palatino', serif;
            font-style: italic;
        }
        
        .theme-werewolves h1 {
            font-family: 'Impact', 'Arial Black', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* H2 et H3 dans les boutons d'interface - police uniforme pour √©viter les d√©bordements */
        button h2, button h3,
        .theme-card h2, .theme-card h3 {
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif !important;
            font-style: normal !important;
            text-transform: none !important;
            letter-spacing: normal !important;
        }
        
        /* Autres H2 et H3 peuvent garder les polices th√©matiques */
        .theme-minotaurs h2:not(button h2):not(.theme-card h2),
        .theme-minotaurs h3:not(button h3):not(.theme-card h3) {
            font-family: 'Georgia', 'Times New Roman', serif;
            text-transform: uppercase;
        }
        
        .theme-krakens h2:not(button h2):not(.theme-card h2),
        .theme-krakens h3:not(button h3):not(.theme-card h3) {
            font-family: 'Trebuchet MS', 'Segoe UI', sans-serif;
            letter-spacing: 0.5px;
        }
        
        .theme-phoenix h2:not(button h2):not(.theme-card h2),
        .theme-phoenix h3:not(button h3):not(.theme-card h3) {
            font-family: 'Book Antiqua', 'Palatino', serif;
            font-style: italic;
        }
        
        .theme-werewolves h2:not(button h2):not(.theme-card h2),
        .theme-werewolves h3:not(button h3):not(.theme-card h3) {
            font-family: 'Impact', 'Arial Black', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Boutons th√©matiques */
        .theme-button {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition-theme);
            box-shadow: 0 4px 15px var(--glow-color);
            position: relative;
            overflow: hidden;
            z-index: 10;
        }

        .theme-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .theme-button:hover::before {
            width: 300px;
            height: 300px;
        }

        /* Textes avec glow th√©matique */
        .theme-text-glow {
            color: var(--text-primary);
            text-shadow: 
                0 0 10px var(--glow-color),
                0 0 20px var(--glow-color),
                0 0 30px var(--primary-color);
        }

        /* === AVATARS ANIM√âS DES FRANCHISES === */

        /* Minotaurs - Taureau qui charge */
        .minotaur-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: charge 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.5));
        }
        
        .theme-minotaurs .minotaur-avatar {
            filter: drop-shadow(0 0 20px var(--primary-color)) drop-shadow(0 0 40px var(--secondary-color));
        }
        
        @keyframes charge {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            50% { transform: translateX(-3px) rotate(-2deg); }
        }

        /* Krakens - Tentacules qui ondulent */
        .kraken-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: tentacles 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 100, 255, 0.5));
        }
        
        .theme-krakens .kraken-avatar {
            filter: drop-shadow(0 0 20px var(--primary-color)) drop-shadow(0 0 40px var(--accent-color));
        }

        @keyframes tentacles {
            0%, 100% { transform: rotate(0deg) scale(1); }
            33% { transform: rotate(2deg) scale(1.05); }
            66% { transform: rotate(-2deg) scale(0.95); }
        }

        /* Phoenix - Flammes qui dansent */
        .phoenix-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: flames 2s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.7));
        }
        
        .theme-phoenix .phoenix-avatar {
            filter: drop-shadow(0 0 25px var(--primary-color)) drop-shadow(0 0 50px var(--accent-color));
        }

        @keyframes flames {
            0%, 100% { transform: translateY(0px) scale(1); }
            25% { transform: translateY(-2px) scale(1.1); }
            75% { transform: translateY(1px) scale(0.9); }
        }

        /* Werewolves - Yeux qui brillent */
        .werewolf-avatar {
            display: inline-block;
            font-size: 3rem;
            filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.4));
        }
        
        .theme-werewolves .werewolf-avatar {
            filter: drop-shadow(0 0 20px var(--primary-color)) drop-shadow(0 0 40px var(--accent-color));
        }


        /* Effet de hover pour tous les avatars */
        .franchise-avatar:hover {
            transform: scale(1.2);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        /* Particules de fond optionnelles */
        .franchise-card {
            position: relative;
            overflow: hidden;
        }

        .franchise-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: sparkle 10s linear infinite;
            pointer-events: none;
        }

        @keyframes sparkle {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-20px, -20px) rotate(360deg); }
        }

        /* Effet de transition entre th√®mes - Supprim√© pour √©viter les √©clairs */
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // D√©finition des badges individuels
        // Remplacez les d√©finitions de badges dans le frontend par celles-ci :
const individualBadges = {
  // === S√âRIES (4 badges) ===
  hot_streak: {
    id: 'hot_streak',
    name: 'Hot Streak',
    emoji: 'üî•',
    description: '5 actions positives d\'affil√©e',
    points: 5,
    rarity: 'bronze'
  },
  tsunami: {
    id: 'tsunami',
    name: 'Tsunami',
    emoji: 'üåä',
    description: '10 actions positives d\'affil√©e',
    points: 10,
    rarity: 'argent'
  },
  unstoppable: {
    id: 'unstoppable',
    name: 'Unstoppable',
    emoji: 'üöÄ',
    description: '15 actions positives d\'affil√©e',
    points: 20,
    rarity: 'or'
  },
  on_fire: {
    id: 'on_fire',
    name: 'On Fire',
    emoji: 'üí™',
    description: '2 Hardworker en 2 semaines',
    points: 10,
    rarity: 'argent'
  },
  
  // === PERS√âV√âRANCE (2 badges) ===
  phoenix: {
    id: 'phoenix',
    name: 'Phoenix',
    emoji: 'ü¶Ö',
    description: 'Remonter de -50 √† +50 points',
    points: 20,
    rarity: 'or'
  },
  marathon_runner: {
    id: 'marathon_runner',
    name: 'Marathon Runner',
    emoji: 'üèÉ',
    description: 'Actions positives 5 jours cons√©cutifs',
    points: 5,
    rarity: 'bronze'
  },
  
  // === SOCIAUX/√âQUIPE (2 badges) ===
  veteran: {
    id: 'veteran',
    name: 'Veteran',
    emoji: 'üéñÔ∏è',
    description: 'Top 3 de sa franchise pendant 2 mois',
    points: 20,
    rarity: 'or'
  },
  team_player: {
    id: 'team_player',
    name: 'Team Player',
    emoji: 'ü§ù',
    description: 'Sa franchise gagne le + de points en 1 semaine',
    points: 5,
    rarity: 'bronze'
  },
  
  // === SP√âCIAUX & RARES (4 badges) ===
  showtime: {
    id: 'showtime',
    name: 'Showtime',
    emoji: 'üé™',
    description: 'Recevoir F√©licitations 3 fois',
    points: 35,
    rarity: 'diamant'
  },
  captain_courage: {
    id: 'captain_courage',
    name: 'Captain Courage',
    emoji: 'ü¶æ',
    description: 'Arbitrer ou tenir table de marque 5 fois en 3 mois',
    points: 18,
    rarity: 'or'
  },
  clockwork: {
    id: 'clockwork',
    name: 'Clockwork',
    emoji: '‚è∞',
    description: 'Aucun retard pendant 3 mois',
    points: 12,
    rarity: 'argent'
  },
  christmas_magic: {
    id: 'christmas_magic',
    name: 'Christmas Magic',
    emoji: 'üéÑ',
    description: '3 Actions positives du 15 au 21 d√©cembre (aucune n√©gative)',
    points: 12,
    rarity: 'argent'
  }
};
       const collectiveBadges = {

  // === PERFORMANCES (4 badges) ===
  rocketLaunch: {
    id: 'rocket_launch',
    name: 'Rocket Launch',
    emoji: 'üöÄ',
    description: '+80 points collectifs en 1 semaine',
    points: 20,
    rarity: 'bronze'
  },
  tidalWave: {
    id: 'tidal_wave',
    name: 'Tidal Wave',
    emoji: 'üåä',
    description: '+200 points collectifs en 1 mois',
    points: 100,
    rarity: 'or'
  },
  lightningStrike: {
    id: 'lightning_strike',
    name: 'Lightning Strike',
    emoji: '‚ö°',
    description: 'Tous les membres gagnent points m√™me jour',
    points: 20,
    rarity: 'bronze'
  },
  houseOnFire: {
    id: 'house_on_fire',
    name: 'House on Fire',
    emoji: 'üî•',
    description: '80% membres actions positives en 1 semaine',
    points: 50,
    rarity: 'argent'
  },
  
  // === SOLIDARIT√â (4 badges) ===
  unitedWeStand: {
    id: 'united_we_stand',
    name: 'United We Stand',
    emoji: 'ü§ù',
    description: 'Aucun membre n√©gatif pendant 2 semaines',
    points: 50,
    rarity: 'argent'
  },
  perfectBalance: {
    id: 'perfect_balance',
    name: 'Perfect Balance',
    emoji: '‚öñÔ∏è',
    description: 'Tous membres entre 25-75 points',
    points: 100,
    rarity: 'or'
  },
  harmony: {
    id: 'harmony',
    name: 'Harmony',
    emoji: 'üåà',
    description: '√âcart <50 points entre 1er et dernier (actif en d√©cembre)',
    points: 50,
    rarity: 'argent'
  }
};

        // Fonction pour obtenir la couleur selon la raret√©
        const getRarityColor = (rarity) => {
          switch(rarity) {
            case 'common': return 'border-gray-400';
            case 'rare': return 'border-blue-400';
            case 'epic': return 'border-purple-400';
            case 'legendary': return 'border-yellow-400';
            default: return 'border-gray-400';
          }
        };

        // Composant BadgeDisplay corrig√©
const BadgeDisplay = ({ badges }) => {
  if (!badges || badges.length === 0) return null;
  
  return (
    <div className="flex flex-wrap gap-1 mt-2">
      {badges.map((badge, index) => {
        // G√©rer les diff√©rents formats de badges
        const badgeId = badge.badge_id || badge.id;
        const badgeName = badge.badge_name || badge.name;
        const badgeEmoji = badge.badge_emoji || badge.emoji;
        const badgeDescription = badge.description || '';
        const badgePoints = badge.points || 0;
        
        return (
          <span 
            key={badgeId || index} 
            className="text-xl cursor-help" 
            title={`${badgeName} - ${badgeDescription} (+${badgePoints} pts)`}
          >
            {badgeEmoji || 'üèÖ'}
          </span>
        );
      })}
    </div>
  );
};

        // Composant NotificationSystem
        const NotificationSystem = ({ notifications }) => {
          if (!notifications || notifications.length === 0) return null;
          
          return (
            <div className="fixed top-4 right-4 z-50 space-y-2 max-w-sm">
              {notifications.map((notif, index) => (
                <div
                  key={index}
                  className="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-lg shadow-2xl"
                >
                  {notif}
                </div>
              ))}
            </div>
          );
        };
// Composant MVP Section
const MVPSection = ({ period = 'week' }) => {
  const [mvpData, setMvpData] = useState(null);
  const [loading, setLoading] = useState(true);

  const loadMVPData = async () => {
    try {
      setLoading(true);
      const response = await fetch(`/api/mvp/current?period=${period}`);
      const data = await response.json();
      setMvpData(data);
    } catch (error) {
      console.error('Erreur lors du chargement des MVP:', error);
    }
    setLoading(false);
  };

  useEffect(() => {
    loadMVPData();
  }, [period]);

  if (loading) return (
    <div className="text-center text-white">
      <div className="text-2xl">Chargement des MVP...</div>
    </div>
  );

  if (!mvpData) return (
    <div className="text-center text-white">
      <div className="text-xl text-gray-400">Pas encore de donn√©es pour cette p√©riode</div>
    </div>
  );

  const getPeriodLabel = (period) => {
    switch(period) {
      case 'week': return 'de la Semaine';
      case 'month': return 'du Mois';
      case 'trimester': return 'du Trimestre';
      default: return 'de la P√©riode';
    }
  };

  return (
    <div className="space-y-6">
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {/* MVP Acad√©mique */}
        <div className="bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl p-6 shadow-2xl">
          <h3 className="text-2xl font-bold text-white mb-4 text-center">
            MVP Acad√©mique {getPeriodLabel(period)}
          </h3>
          {mvpData.mvps.academic ? (
            <div className="text-center">
              <div className="text-3xl font-bold text-white mb-2">
                {mvpData.mvps.academic.player_name}
              </div>
              <div className="text-blue-200 text-lg mb-2">
                {mvpData.mvps.academic.franchise}
              </div>
              <div className="bg-black/30 rounded-lg p-3">
                <div className="text-2xl font-bold text-white">
                  +{mvpData.mvps.academic.academic_points} pts
                </div>
                <div className="text-blue-200 text-sm">
                  Total: {mvpData.mvps.academic.total_score} pts
                </div>
              </div>
            </div>
          ) : (
            <div className="text-center text-blue-200">
              Aucun MVP acad√©mique cette p√©riode
            </div>
          )}
        </div>

        {/* MVP Sport */}
        <div className="bg-gradient-to-r from-orange-600 to-red-600 rounded-xl p-6 shadow-2xl">
          <h3 className="text-2xl font-bold text-white mb-4 text-center">
            MVP Sport {getPeriodLabel(period)}
          </h3>
          {mvpData.mvps.sport ? (
            <div className="text-center">
              <div className="text-3xl font-bold text-white mb-2">
                {mvpData.mvps.sport.player_name}
              </div>
              <div className="text-orange-200 text-lg mb-2">
                {mvpData.mvps.sport.franchise}
              </div>
              <div className="bg-black/30 rounded-lg p-3">
                <div className="text-2xl font-bold text-white">
                  +{mvpData.mvps.sport.sport_points} pts
                </div>
                <div className="text-orange-200 text-sm">
                  Total: {mvpData.mvps.sport.total_score} pts
                </div>
              </div>
            </div>
          ) : (
            <div className="text-center text-orange-200">
              Aucun MVP sport cette p√©riode
            </div>
          )}
        </div>

        {/* MVP Progression */}
        <div className="bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl p-6 shadow-2xl">
          <h3 className="text-2xl font-bold text-white mb-4 text-center">
            MVP Progression {getPeriodLabel(period)}
          </h3>
          {mvpData.mvps.progression ? (
            <div className="text-center">
              <div className="text-3xl font-bold text-white mb-2">
                {mvpData.mvps.progression.player_name}
              </div>
              <div className="text-green-200 text-lg mb-2">
                {mvpData.mvps.progression.franchise}
              </div>
              <div className="bg-black/30 rounded-lg p-3">
                <div className="text-2xl font-bold text-white">
                  +{mvpData.mvps.progression.total_points} pts
                </div>
                <div className="text-green-200 text-sm">
                  Total: {mvpData.mvps.progression.total_score} pts
                </div>
              </div>
            </div>
          ) : (
            <div className="text-center text-green-200">
              Aucun MVP progression cette p√©riode
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

// Composant Franchise Stats
const FranchiseStatsSection = ({ period = 'week' }) => {
  const [franchiseData, setFranchiseData] = useState(null);
  const [loading, setLoading] = useState(true);

  const loadFranchiseData = async () => {
    try {
      setLoading(true);
      const response = await fetch(`/api/stats/franchise-breakdown?period=${period}`);
      const data = await response.json();
      setFranchiseData(data);
    } catch (error) {
      console.error('Erreur lors du chargement des stats franchises:', error);
    }
    setLoading(false);
  };

  useEffect(() => {
    loadFranchiseData();
  }, [period]);

  if (loading) return <div className="text-center text-white text-xl">Chargement...</div>;

// V√©rification plus robuste
if (!franchiseData) {
  return <div className="text-center text-white text-xl">Erreur de chargement des donn√©es</div>;
}

if (!franchiseData.franchise_stats || franchiseData.franchise_stats.length === 0) {
  return (
    <div className="text-center text-white">
      <div className="text-xl mb-4">Pas encore de donn√©es pour cette p√©riode</div>
      <div className="text-gray-400">Ajoutez des points aux √©l√®ves pour voir les statistiques appara√Ætre</div>
    </div>
  );
}

  return (
    <div className="space-y-6">
      {franchiseData.most_balanced && (
        <div className="bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl p-6 text-center">
          <h3 className="text-2xl font-bold text-white mb-2">Franchise la Plus √âquilibr√©e</h3>
          <div className="text-3xl font-bold text-white">{franchiseData.most_balanced.franchise}</div>
          <div className="text-purple-200">
            Sport: {franchiseData.most_balanced.sport_percentage}% | 
            Acad√©mique: {franchiseData.most_balanced.academic_percentage}%
          </div>
        </div>
      )}

      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        {franchiseData.franchise_stats.map((franchise, index) => {
          const franchiseColors = {
            Minotaurs: 'from-red-600 to-red-800',
            Krakens: 'from-blue-600 to-blue-800',
            Phoenix: 'from-purple-600 to-purple-800',
            Werewolves: 'from-green-600 to-green-800',
            'Non-Draft√©s': 'from-gray-600 to-gray-800'
          };

          return (
            <div key={franchise.franchise} className={`bg-gradient-to-r ${franchiseColors[franchise.franchise]} rounded-xl p-6`}>
              <h3 className="text-2xl font-bold text-white mb-4 text-center">
                {franchise.franchise}
              </h3>
              
              <div className="space-y-3">
                <div className="bg-black/30 rounded-lg p-3 text-center">
                  <div className="text-3xl font-bold text-white">{franchise.total_points}</div>
                  <div className="text-white/80">Points Total</div>
                </div>

                <div className="bg-black/30 rounded-lg p-3">
                  <div className="flex justify-between mb-2">
                    <span className="text-white">Sport</span>
                    <span className="text-white font-bold">{franchise.total_sport} pts ({franchise.sport_percentage}%)</span>
                  </div>
                  <div className="w-full bg-white/20 rounded-full h-3 mb-3">
                    <div 
                      className="bg-orange-400 h-3 rounded-full" 
                      style={{width: `${franchise.sport_percentage}%`}}
                    ></div>
                  </div>
                  
                  <div className="flex justify-between mb-2">
                    <span className="text-white">Acad√©mique</span>
                    <span className="text-white font-bold">{franchise.total_academic} pts ({franchise.academic_percentage}%)</span>
                  </div>
                  <div className="w-full bg-white/20 rounded-full h-3">
                    <div 
                      className="bg-blue-400 h-3 rounded-full" 
                      style={{width: `${franchise.academic_percentage}%`}}
                    ></div>
                  </div>
                </div>

                <div className="text-center text-white/80 text-sm">
                  {franchise.active_players} √©l√®ve{franchise.active_players > 1 ? 's' : ''} actif{franchise.active_players > 1 ? 's' : ''}
                </div>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Composant Hall of Fame
const HallOfFameSection = () => {
  const [hofData, setHofData] = useState(null);
  const [loading, setLoading] = useState(true);

  const loadHallOfFame = async () => {
    try {
      setLoading(true);
      const response = await fetch('/api/hall-of-fame');
      const data = await response.json();
      setHofData(data);
    } catch (error) {
      console.error('Erreur lors du chargement du Hall of Fame:', error);
    }
    setLoading(false);
  };

  useEffect(() => {
    loadHallOfFame();
  }, []);

    if (loading) return <div className="text-center text-white text-xl">Chargement...</div>;

if (!hofData) {
  return (
    <div className="text-center text-white">
      <div className="text-xl mb-4">Donn√©es non disponibles</div>
      <div className="text-gray-400">Le Hall of Fame se remplira automatiquement quand des √©l√®ves atteindront des paliers</div>
    </div>
  );
}

  return (
    <div className="space-y-6">
      {hofData.absolute_record && (
        <div className="bg-gradient-to-r from-yellow-500 via-yellow-600 to-yellow-700 rounded-xl p-6 text-center shadow-2xl">
          <h2 className="text-3xl font-bold text-white mb-4">RECORD ABSOLU</h2>
          <div className="text-5xl font-bold text-white mb-2">{hofData.absolute_record.player_name}</div>
          <div className="text-2xl text-yellow-100 mb-2">{hofData.absolute_record.franchise}</div>
          <div className="text-6xl font-bold text-white">{hofData.absolute_record.score} points</div>
        </div>
      )}

      <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
        <h3 className="text-2xl font-bold text-white mb-6 text-center">Records Actuels</h3>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          {hofData.current_records && hofData.current_records.map(record => (
            <div key={record.id} className="bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg p-4 text-center">
              <h4 className="text-white font-bold mb-2">{record.record_type}</h4>
              <div className="text-2xl font-bold text-white">{record.player_name}</div>
              <div className="text-purple-200 text-sm">{record.franchise}</div>
              <div className="text-xl font-bold text-white mt-2">{record.score} pts</div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};
        const App = () => {
          const [currentView, setCurrentView] = useState('home');
          const [userType, setUserType] = useState(null);
          const [players, setPlayers] = useState([]);
          const [expandedDropdown, setExpandedDropdown] = useState(null);
          const [selectedPlayerHistory, setSelectedPlayerHistory] = useState(null);
          const [playerHistory, setPlayerHistory] = useState([]);
          const [loading, setLoading] = useState(false);
          const [password, setPassword] = useState('');
          const [loginError, setLoginError] = useState('');
          const [teacherName, setTeacherName] = useState('');
          const [selectedStudent, setSelectedStudent] = useState('');
          const [selectedStudentForDraft, setSelectedStudentForDraft] = useState('');
          const [newStudentName, setNewStudentName] = useState('');
          const [newStudentFranchise, setNewStudentFranchise] = useState('Non-Draft√©s');
          const [draftFranchise, setDraftFranchise] = useState('');
          const [selectedPlayerForGraph, setSelectedPlayerForGraph] = useState(null);
          const [playerProgressionData, setPlayerProgressionData] = useState(null);
          const [currentChart, setCurrentChart] = useState(null);
          const [searchName, setSearchName] = useState('');
          const [foundPlayer, setFoundPlayer] = useState(null);
          const [searchHistory, setSearchHistory] = useState([]);
          const [showEvolutionChart, setShowEvolutionChart] = useState(false);
          const [showDraftCelebration, setShowDraftCelebration] = useState(false);
          const [hasSeenDraftMessage, setHasSeenDraftMessage] = useState({});
          const [chartData, setChartData] = useState(null);
          const [chartType, setChartType] = useState('player');
          // √âtats pour les badges
          const [playerBadges, setPlayerBadges] = useState({});
          const [franchiseBadges, setFranchiseBadges] = useState({});
          const [notifications, setNotifications] = useState([]);
          const [activeTab, setActiveTab] = useState('general');
          const [selectedPeriod, setSelectedPeriod] = useState('week');
          // √âtat pour le th√®me actuel
          const [currentTheme, setCurrentTheme] = useState('');
          const [selectedFranchiseView, setSelectedFranchiseView] = useState(null);
          // Message personnalis√© pour la page √©l√®ves
          const [studentPageMessage, setStudentPageMessage] = useState('');
          // √âtats pour le renommage
          const [renamePlayerName, setRenamePlayerName] = useState('');
          const [newPlayerName, setNewPlayerName] = useState('');
          
          // === GESTION DES TH√àMES DYNAMIQUES ===
          
          // Fonction pour obtenir le nom du th√®me selon la franchise
          const getThemeClass = (franchise) => {
            const themeMap = {
              'Minotaurs': 'theme-minotaurs',
              'Krakens': 'theme-krakens', 
              'Phoenix': 'theme-phoenix',
              'Werewolves': 'theme-werewolves',
              'Non-Draft√©s': 'theme-undrafted',
            };
            return themeMap[franchise] || '';
          };
          
          // Fonction pour appliquer le th√®me dynamiquement
          const applyTheme = (franchise) => {
            const themeClass = getThemeClass(franchise);
            // Retirer tous les th√®mes existants
            document.documentElement.className = document.documentElement.className
              .replace(/theme-\w+/g, '');
            // Ajouter le nouveau th√®me
            if (themeClass) {
              document.documentElement.classList.add(themeClass);
            }
          };
          
          // Maximes sacr√©es des franchises
          const getFranchiseMaxime = (franchise) => {
            const maximes = {
              'Minotaurs': {
                english: "Horns high, hearts strong, victory awaits",
                french: "Cornes hautes, c≈ìurs forts, la victoire nous attend",
                ornament: "‚öîÔ∏è"
              },
              'Krakens': {
                english: "Deep waters forge the strongest souls", 
                french: "Les eaux profondes forgent les √¢mes les plus fortes",
                ornament: "üåä"
              },
              'Phoenix': {
                english: "Burn bright, rise higher, soar forever",
                french: "Br√ªle fort, √©l√®ve-toi plus haut, plane pour l'√©ternit√©", 
                ornament: "üî•"
              },
              'Werewolves': {
                english: "Together we howl, together we triumph",
                french: "Ensemble nous hurlons, ensemble nous triomphons",
                ornament: "üåô"
              },
              'Non-Draft√©s': {
                english: "Every champion starts with a dream",
                french: "Chaque champion commence par un r√™ve",
                ornament: "‚≠ê"
              }
            };
            return maximes[franchise] || null;
          };

          // Fonction pour changer le th√®me de l'application
          const changeTheme = (franchise) => {
            const body = document.body;
            const html = document.documentElement;
            
            // Retirer tous les th√®mes existants
            body.className = body.className.replace(/theme-\w+/g, '');
            html.className = html.className.replace(/theme-\w+/g, '');
            
            if (franchise) {
              const themeClass = getThemeClass(franchise);
              if (themeClass) {
                // Appliquer le nouveau th√®me directement sans transition
                body.classList.add(themeClass);
                html.classList.add(themeClass);
                setCurrentTheme(themeClass);
              }
            }
          };

          // Fonction pour obtenir la franchise dominante
          const getDominantFranchise = () => {
            if (!players || players.length === 0) return null;
            
            const franchiseScores = {};
            players.forEach(player => {
              if (!franchiseScores[player.franchise]) {
                franchiseScores[player.franchise] = 0;
              }
              franchiseScores[player.franchise] += player.score;
            });
            
            return Object.keys(franchiseScores).reduce((a, b) => 
              franchiseScores[a] > franchiseScores[b] ? a : b
            );
          };

          // Effet pour changer automatiquement le th√®me selon la franchise s√©lectionn√©e ou dominante
          useEffect(() => {
            let franchiseToUse = selectedFranchiseView;
            
            if (!franchiseToUse && currentView === 'home') {
              franchiseToUse = getDominantFranchise();
            }
            
            changeTheme(franchiseToUse);
          }, [selectedFranchiseView, currentView, players]);

          // Fonction pour g√©rer le clic sur une carte de franchise
          const handleFranchiseClick = (franchise) => {
            setSelectedFranchiseView(selectedFranchiseView === franchise ? null : franchise);
          };

          // === FONCTIONS BADGES SAISONNIERS ===
          
          // Fonction pour v√©rifier si on est dans une p√©riode saisonni√®re
          const getCurrentSeasonalPeriod = () => {
            const now = new Date();
            const currentMonth = now.getMonth() + 1; // getMonth() retourne 0-11
            const currentDay = now.getDate();
            
            // No√´l : 15-21 d√©cembre (mois 12)
            if (currentMonth === 12 && currentDay >= 15 && currentDay <= 21) {
              return 'christmas';
            }
            
            return null;
          };
          
          // Fonction pour v√©rifier si une date est dans une p√©riode saisonni√®re
          const isDateInSeasonalPeriod = (date, period) => {
            const checkDate = new Date(date);
            const month = checkDate.getMonth() + 1;
            const day = checkDate.getDate();
            
            if (period === 'christmas') {
              return month === 12 && day >= 15 && day <= 21;
            }
            
            return false;
          };
          
          // Fonction pour compter les actions positives dans une p√©riode saisonni√®re
          const countSeasonalActions = (playerName, period) => {
            if (!searchHistory || searchHistory.length === 0) return 0;
            
            return searchHistory.filter(entry => {
              return entry.points > 0 && isDateInSeasonalPeriod(entry.timestamp, period);
            }).length;
          };
          
          // Fonction pour v√©rifier s'il y a des actions n√©gatives dans une p√©riode saisonni√®re
          const hasNegativeSeasonalActions = (playerName, period) => {
            if (!searchHistory || searchHistory.length === 0) return false;
            
            return searchHistory.some(entry => {
              return entry.points < 0 && isDateInSeasonalPeriod(entry.timestamp, period);
            });
          };
          
          // Fonction pour v√©rifier si un joueur m√©rite un badge saisonnier
          const checkSeasonalBadges = (playerName) => {
            const earnedBadges = [];
            const currentPeriod = getCurrentSeasonalPeriod();
            
            // V√©rifier No√´l (besoin de 3 actions positives du 15-21 d√©cembre ET aucune action n√©gative)  
            const christmasActions = countSeasonalActions(playerName, 'christmas');
            const hasChristmasNegative = hasNegativeSeasonalActions(playerName, 'christmas');
            if (christmasActions >= 3 && !hasChristmasNegative) {
              earnedBadges.push('christmas_magic');
            }
            
            return earnedBadges;
          };

          // Fonction pour obtenir le grade basketball selon le score
          const getBadge = (score) => {
            // Grade Ultime
            if (score >= 250) return { 
              emoji: 'üêê', 
              name: 'GOAT', 
              fullName: 'Greatest Of All Time',
              color: 'text-purple-300',
              bgColor: 'from-purple-600 to-purple-800',
              description: 'Le plus grand de tous les temps'
            };
            
            // Grades Elite
            if (score >= 200) return { 
              emoji: 'üèõÔ∏è', 
              name: 'Hall of Fame', 
              fullName: 'Hall of Fame',
              color: 'text-yellow-300',
              bgColor: 'from-yellow-500 to-yellow-700',
              description: 'L√©gende du sport'
            };
            if (score >= 150) return { 
              emoji: 'üî•', 
              name: 'Superstar', 
              fullName: 'Superstar',
              color: 'text-orange-300',
              bgColor: 'from-orange-500 to-red-600',
              description: 'Ph√©nom√®ne basketball'
            };
            
            // Grades Confirm√©s
            if (score >= 100) return { 
              emoji: 'üåü', 
              name: 'All-Star', 
              fullName: 'All-Star',
              color: 'text-blue-300',
              bgColor: 'from-blue-500 to-blue-700',
              description: 'S√©lectionn√© parmi l\'√©lite'
            };
            if (score >= 75) return { 
              emoji: 'üíé', 
              name: 'Franchise Player', 
              fullName: 'Franchise Player',
              color: 'text-cyan-300',
              bgColor: 'from-cyan-500 to-blue-600',
              description: 'Pilier de l\'√©quipe'
            };
            
            // Grades D√©veloppement
            if (score >= 50) return { 
              emoji: '‚≠ê', 
              name: 'Starting Five', 
              fullName: 'Starting Five',
              color: 'text-green-300',
              bgColor: 'from-green-500 to-green-700',
              description: 'Titulaire indiscutable'
            };
            if (score >= 25) return { 
              emoji: 'üèÉ', 
              name: 'Sixth Man', 
              fullName: 'Sixth Man',
              color: 'text-emerald-300',
              bgColor: 'from-emerald-500 to-green-600',
              description: 'Premier rempla√ßant de qualit√©'
            };
            
            // Grades D√©butants
            if (score >= 10) return { 
              emoji: 'üèÄ', 
              name: 'Rookie', 
              fullName: 'Rookie',
              color: 'text-amber-300',
              bgColor: 'from-amber-500 to-orange-500',
              description: 'D√©butant prometteur'
            };
            if (score >= 0) return { 
              emoji: 'üë∂', 
              name: 'Freshman', 
              fullName: 'Freshman',
              color: 'text-yellow-300',
              bgColor: 'from-yellow-400 to-amber-500',
              description: 'Premi√®re ann√©e, apprend les bases'
            };
            
            // Grades N√©gatifs
            if (score >= -25) return { 
              emoji: 'üìâ', 
              name: 'Plot', 
              fullName: 'Plot',
              color: 'text-gray-400',
              bgColor: 'from-gray-500 to-gray-700',
              description: 'Personnage sans importance'
            };
            if (score >= -50) return { 
              emoji: 'ü™ë', 
              name: 'Benchwarmer', 
              fullName: 'Benchwarmer',
              color: 'text-red-400',
              bgColor: 'from-red-500 to-red-700',
              description: 'Clou√© sur le banc'
            };
            
            // Pire niveau
            return { 
              emoji: 'üóëÔ∏è', 
              name: 'Scrub', 
              fullName: 'Scrub',
              color: 'text-red-600',
              bgColor: 'from-red-700 to-red-900',
              description: 'Le pire niveau possible'
            };
          };

          // Fonction pour obtenir l'avatar anim√© de la franchise
          const getFranchiseAvatar = (franchise) => {
            const avatars = {
              Minotaurs: { emoji: 'üêÇ', class: 'minotaur-avatar', name: 'Taureau Enrag√©' },
              Krakens: { emoji: 'üêô', class: 'kraken-avatar', name: 'Kraken des Profondeurs' },
              Phoenix: { emoji: 'üî•', class: 'phoenix-avatar', name: 'Phoenix √âternel' },
              Werewolves: { emoji: 'üê∫', class: 'werewolf-avatar', name: 'Loup-Garou' },
              'Non-Draft√©s': { emoji: '‚ú®', class: 'undrafted-avatar', name: 'Espoir' }
            };
            return avatars[franchise] || { emoji: '‚ö°', class: 'franchise-avatar', name: 'Guerrier' };
          };

          // Actions positives et n√©gatives
          const positiveActions = [
  // ====== CAT√âGORIE SPORT ====== 
  { label: 'üèÄ Hardworker', points: 6, category: 'sport' },
  { label: 'üèÄ Bon entrainement club', points: 4, category: 'sport' },
  { label: 'üèÜ Victoire weekend (R√©gion/France)', points: 6, category: 'sport' },
  { label: 'ü•à D√©faite weekend (R√©gion/France)', points: 2, category: 'sport' },
  { label: 'üèÖ Victoire weekend (D√©partement)', points: 4, category: 'sport' },
  { label: 'üéØ D√©faite weekend (D√©partement)', points: 1, category: 'sport' },
  { label: '‚≠ê Extra basket (cross, AS...) - Excellent', points: 10, category: 'sport' },
  { label: '‚≠ê Extra basket (cross, AS...) - Tr√®s bien', points: 6, category: 'sport' },
  { label: '‚≠ê Extra basket (cross, AS...) - Bien', points: 3, category: 'sport' },
  { label: 'üéñÔ∏è Parcours s√©lection', points: 10, category: 'sport' },
  { label: 'üåü Tournoi des √©toiles', points: 25, category: 'sport' },
  { label: 'üí™ Entrainements facultatifs', points: 3, category: 'sport' },
  { label: 'üìä Table de marque/Arbitrage weekend', points: 5, category: 'sport' },
  
  // ====== CAT√âGORIE ACAD√âMIQUE ======
  { label: 'üìö Observation positive', points: 5, category: 'academic' },
  { label: 'üìö Participation active en classe', points: 4, category: 'academic' },
  { label: 'üìö Travail de qualit√© (oral/√©crit)', points: 4, category: 'academic' },
  { label: 'üìö Activit√©s facultatives (sentinelle)', points: 5, category: 'academic' },
  { label: 'üìö Activit√©s facultatives (ateliers devoirs)', points: 4, category: 'academic' },
  { label: 'üìö Activit√©s facultatives (d√©l√©gu√©)', points: 6, category: 'academic' },
  { label: 'üìö Activit√©s facultatives (conseil admin)', points: 8, category: 'academic' },
  { label: 'üèÜ F√©licitations', points: 25, category: 'academic' },
  { label: 'üéñÔ∏è Compliments', points: 15, category: 'academic' },
  { label: 'üëç Encouragements', points: 10, category: 'academic' },
  
  // === BONUS FLEXIBLES ===
  { label: 'Bonus Sport', points: 2, category: 'sport' },
  { label: 'Bonus Scolaire', points: 2, category: 'academic' },
  { label: 'Bonus Sport', points: 3, category: 'sport' },
  { label: 'Bonus Scolaire', points: 3, category: 'academic' },
  { label: 'Bonus Sport', points: 5, category: 'sport' },
  { label: 'Bonus Scolaire', points: 5, category: 'academic' },
  { label: 'Bonus Sport', points: 10, category: 'sport' },
  { label: 'Bonus Scolaire', points: 10, category: 'academic' }
];
          
              const negativeActions = [
  // ====== CAT√âGORIE SPORT ====== 
  { label: 'Mauvaise attitude/retard entrainement', points: -4, category: 'sport' },
  { label: 'Absences r√©p√©t√©es/non justifi√©es club', points: -4, category: 'sport' },
  
  // ====== CAT√âGORIE ACAD√âMIQUE ======
  { label: 'Observation n√©gative', points: -5, category: 'academic' },
  { label: 'Exclusion de cours', points: -8, category: 'academic' },
  { label: 'Exclusion temporaire √©tablissement', points: -15, category: 'academic' },
  { label: 'Travail non fait', points: -3, category: 'academic' },
  { label: 'Retard/absence non justifi√©e', points: -3, category: 'academic' },
  { label: 'Mauvaise attitude en classe (perturbe)', points: -5, category: 'academic' },
  
  // === P√âNALIT√âS FLEXIBLES ===
  { label: 'P√©nalit√© Sport', points: -2, category: 'sport' },
  { label: 'P√©nalit√© Scolaire', points: -2, category: 'academic' },
  { label: 'P√©nalit√© Sport', points: -3, category: 'sport' },
  { label: 'P√©nalit√© Scolaire', points: -3, category: 'academic' },
  { label: 'P√©nalit√© Sport', points: -5, category: 'sport' },
  { label: 'P√©nalit√© Scolaire', points: -5, category: 'academic' }
];

          // Couleurs des franchises
          const franchiseColors = {
            Minotaurs: 'from-red-600 to-red-800',
            Krakens: 'from-blue-600 to-blue-800',
            Phoenix: 'from-purple-600 to-purple-800',
            Werewolves: 'from-green-600 to-green-800',
            'Non-Draft√©s': 'from-gray-600 to-gray-800'
          };

          // V√©rifier le mot de passe professeur
          const verifyTeacher = async () => {
            if (!password.trim()) {
              setLoginError('Veuillez entrer un mot de passe');
              return;
            }
            
            if (!teacherName.trim()) {
              setLoginError('Veuillez renseigner votre nom');
              return;
            }
            
            try {
              const response = await fetch('/api/verify-teacher', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password })
              });
              
              const data = await response.json();
              if (data.success) {
                setUserType('teacher');
                setCurrentView('teacher-dashboard');
                setLoginError('');
              } else {
                setLoginError('Mot de passe incorrect');
              }
            } catch (error) {
              setLoginError('Erreur de connexion');
            }
          };

          // Charger les joueurs
          const loadPlayers = async () => {
            try {
              const response = await fetch('/api/players');
              const data = await response.json();
              setPlayers(data);
            } catch (error) {
              console.error('Erreur lors du chargement des joueurs:', error);
            }
          };

          // Ajouter des points (professeurs uniquement)
          const addPoints = async (playerName, points, action) => {
            setLoading(true);
            try {
              const response = await fetch('/api/add-points', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ playerName, points, action, teacherName })
              });
              
              if (response.ok) {
                await loadPlayers();
                setExpandedDropdown(null);
              }
            } catch (error) {
              console.error('Erreur lors de l\'ajout de points:', error);
            }
            setLoading(false);
          };

          // Charger l'historique d'un joueur
          const loadPlayerHistory = async (playerName) => {
            try {
              const response = await fetch(`/api/history/${encodeURIComponent(playerName)}`);
              const data = await response.json();
              setPlayerHistory(data);
              setSelectedPlayerHistory(playerName);
            } catch (error) {
              console.error('Erreur lors du chargement de l\'historique:', error);
            }
          };

          // Charger les donn√©es de progression d'un joueur
          const loadPlayerProgression = async (playerName) => {
            try {
              const response = await fetch(`/api/progression/${encodeURIComponent(playerName)}?days=all`);
              const data = await response.json();
              setPlayerProgressionData(data);
              
              // Cr√©er le graphique apr√®s un d√©lai pour s'assurer que le canvas existe
              setTimeout(() => createProgressionChart(data), 100);
            } catch (error) {
              console.error('Erreur lors du chargement de la progression:', error);
            }
          };

          // Cr√©er le graphique d'√©volution avec Chart.js
          const createProgressionChart = (data) => {
            const canvas = document.getElementById('playerChart');
            if (!canvas || !data || !data.data) return;

            const ctx = canvas.getContext('2d');
            
            // D√©truire le graphique pr√©c√©dent s'il existe
            if (currentChart) {
              currentChart.destroy();
            }

            // Pr√©parer les donn√©es pour le graphique
            const dates = data.data.map((item, index) => {
              if (item.date && item.date !== null) {
                const date = new Date(item.date);
                return date.toLocaleDateString('fr-FR', { 
                  day: '2-digit', 
                  month: '2-digit' 
                });
              } else {
                return `Jour ${index + 1}`;
              }
            });
            
            const scores = data.data.map(item => item.cumulative_score);
            const dailyPoints = data.data.map(item => item.daily_points);

            // Cr√©er le graphique
            const chart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: dates,
                datasets: [
                  {
                    label: 'Score Total',
                    data: scores,
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: 'rgb(59, 130, 246)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                  },
                  {
                    label: 'Points du jour',
                    data: dailyPoints,
                    type: 'bar',
                    backgroundColor: 'rgba(16, 185, 129, 0.6)',
                    borderColor: 'rgb(16, 185, 129)',
                    borderWidth: 1,
                    yAxisID: 'y1',
                  }
                ]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                  mode: 'index',
                  intersect: false,
                },
                plugins: {
                  title: {
                    display: true,
                    text: `√âvolution de ${data.playerName}`,
                    font: {
                      size: 16,
                      weight: 'bold'
                    }
                  },
                  legend: {
                    display: true,
                    position: 'top'
                  },
                  tooltip: {
                    callbacks: {
                      title: function(context) {
                        return `Jour: ${context[0].label}`;
                      },
                      label: function(context) {
                        if (context.datasetIndex === 0) {
                          return `Score total: ${context.parsed.y} points`;
                        } else {
                          return `Points gagn√©s: ${context.parsed.y > 0 ? '+' : ''}${context.parsed.y} points`;
                        }
                      }
                    }
                  }
                },
                scales: {
                  x: {
                    display: true,
                    title: {
                      display: true,
                      text: 'Dates'
                    },
                    ticks: {
                      maxTicksLimit: 10
                    }
                  },
                  y: {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    title: {
                      display: true,
                      text: 'Score Total'
                    },
                    grid: {
                      color: 'rgba(0, 0, 0, 0.1)'
                    }
                  },
                  y1: {
                    type: 'linear',
                    display: true,
                    position: 'right',
                    title: {
                      display: true,
                      text: 'Points du Jour'
                    },
                    grid: {
                      drawOnChartArea: false,
                    },
                  },
                }
              }
            });

            setCurrentChart(chart);
          };

          // Annuler la derni√®re action (professeurs uniquement)
          const undoLastAction = async (playerName) => {
            setLoading(true);
            try {
              const response = await fetch(`/api/undo-last/${encodeURIComponent(playerName)}`, {
                method: 'DELETE',
              });
              
              if (response.ok) {
                await loadPlayers();
              }
            } catch (error) {
              console.error('Erreur lors de l\'annulation:', error);
            }
            setLoading(false);
          };

          
          // Renommer un √©l√®ve
          const handleRenameStudent = async () => {
            if (!renamePlayerName || !newPlayerName) {
              alert('Veuillez saisir l\'ancien nom et le nouveau nom');
              return;
            }
            
            if (!confirm(`√ätes-vous s√ªr de vouloir renommer "${renamePlayerName}" en "${newPlayerName}" ?`)) {
              return;
            }
            
            try {
              const response = await fetch('/api/rename-student', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                  oldName: renamePlayerName,
                  newName: newPlayerName
                })
              });
              
              if (response.ok) {
                const result = await response.json();
                alert(`‚úÖ ${result.oldName} renomm√© en ${result.newName}`);
                // Recharger la liste des joueurs
                loadPlayers();
                // Vider les champs
                setRenamePlayerName('');
                setNewPlayerName('');
              } else {
                const error = await response.json();
                alert('Erreur: ' + error.error);
              }
            } catch (error) {
              console.error('Erreur:', error);
              alert('Erreur lors du renommage');
            }
          };

          // √âtat pour le syst√®me de codes d'acc√®s
          const [accessCode, setAccessCode] = React.useState('');
          const [showCodeInput, setShowCodeInput] = React.useState(false);
          const [pendingPlayerName, setPendingPlayerName] = React.useState('');
          
          // √âtat pour les codes d'acc√®s administrateur
          const [studentCodes, setStudentCodes] = React.useState([]);
          const [loadingCodes, setLoadingCodes] = React.useState(false);

          // Fonction de recherche d'√©l√®ve avec code d'acc√®s
          async function searchPlayer(selectedPlayerName = null) {
            const playerName = selectedPlayerName || searchName.trim();
            
            if (!playerName) {
              alert('Veuillez s√©lectionner ou entrer votre nom');
              return;
            }

            // Si on a d√©j√† un code d'acc√®s, l'utiliser directement
            if (accessCode) {
              await verifyAndLoadPlayer(playerName, accessCode);
              return;
            }

            // Sinon, demander le code d'acc√®s
            setPendingPlayerName(playerName);
            setShowCodeInput(true);
          }

          // Fonction pour v√©rifier le code et charger le profil
          async function verifyAndLoadPlayer(playerName, code) {
            try {
              const response = await fetch(`/api/player/${encodeURIComponent(playerName)}?code=${encodeURIComponent(code)}`);
              
              if (response.ok) {
                const player = await response.json();
                setFoundPlayer(player);
                
                const historyResponse = await fetch(`/api/history/${encodeURIComponent(playerName)}?code=${encodeURIComponent(code)}`);
                const history = await historyResponse.json();
                setSearchHistory(history);
                setSearchName(playerName); // Mettre √† jour le champ avec le nom s√©lectionn√©
                setShowCodeInput(false);
                setAccessCode(code); // Sauvegarder le code pour la session
                
                // V√©rifier si l'√©l√®ve a √©t√© r√©cemment draft√© (dans les derni√®res 24 heures)
                const recentDraft = history.find(entry => 
                  entry.action.includes('Draft√© vers') && 
                  (Date.now() - new Date(entry.timestamp).getTime()) < 24 * 60 * 60 * 1000
                );
                
                // Afficher c√©l√©bration si draft√© r√©cemment et pas encore vu
                if (recentDraft && !hasSeenDraftMessage[playerName]) {
                  setShowDraftCelebration(true);
                  setHasSeenDraftMessage(prev => ({ ...prev, [playerName]: true }));
                  
                  // D√©clencher l'animation de confettis
                  setTimeout(() => {
                    triggerDraftConfetti(player.franchise);
                  }, 500);
                }
              } else {
                const errorData = await response.json();
                
                if (errorData.needsCode) {
                  // Code d'acc√®s incorrect
                  alert('‚ùå Code d\'acc√®s incorrect. Veuillez v√©rifier votre code et r√©essayer.');
                  setShowCodeInput(true);
                  return;
                }
                
                setFoundPlayer(null);
                setSearchHistory([]);
                
                // Chercher des noms similaires pour aider l'utilisateur
                const normalizeString = (str) => {
                  return str.toLowerCase()
                            .normalize('NFD')
                            .replace(/[\u0300-\u036f]/g, '');
                };
                
                const similarPlayers = players.filter(player => {
                  const normalizedPlayerName = normalizeString(player.name);
                  const normalizedSearchName = normalizeString(playerName);
                  return normalizedPlayerName.includes(normalizedSearchName) ||
                         normalizedSearchName.includes(normalizedPlayerName);
                });
                
                if (similarPlayers.length > 0) {
                  const suggestions = similarPlayers.slice(0, 3).map(p => p.name).join(', ');
                  alert(`√âl√®ve "${playerName}" non trouv√©. Vouliez-vous dire : ${suggestions} ?`);
                } else {
                  alert('Aucun √©l√®ve trouv√© avec ce nom. V√©rifiez l\'orthographe ou utilisez les suggestions.');
                }
              }
            } catch (error) {
              console.error('Erreur de recherche:', error);
              alert('Erreur lors de la recherche: ' + error.message);
              setShowCodeInput(false);
            }
          }

          // Fonction pour soumettre le code d'acc√®s
          const submitAccessCode = async () => {
            if (!accessCode.trim()) {
              alert('Veuillez entrer votre code d\'acc√®s');
              return;
            }
            
            await verifyAndLoadPlayer(pendingPlayerName, accessCode.trim());
          };

          // Fonction pour annuler la demande de code
          const cancelCodeInput = () => {
            setShowCodeInput(false);
            setAccessCode('');
            setPendingPlayerName('');
            // R√©initialiser compl√®tement la recherche
            setFoundPlayer(null);
            setSearchHistory([]);
          };

          // Fonction pour charger les codes d'acc√®s (professeurs uniquement)
          const loadStudentCodes = async () => {
            setLoadingCodes(true);
            try {
              // Utiliser le mot de passe directement depuis la constante
              const response = await fetch(`/api/all-student-codes?password=GPwinner2026`);
              if (response.ok) {
                const codes = await response.json();
                setStudentCodes(codes);
                console.log('Codes charg√©s:', codes.length);
              } else {
                console.error('Erreur lors du chargement des codes - Status:', response.status);
                const errorText = await response.text();
                console.error('Erreur d√©tail:', errorText);
                setStudentCodes([]);
              }
            } catch (error) {
              console.error('Erreur:', error);
              setStudentCodes([]);
            } finally {
              setLoadingCodes(false);
            }
          };

          // Ajouter un √©l√®ve (professeurs uniquement)
          const addStudent = async () => {
            if (!newStudentName.trim()) {
              alert('Veuillez entrer un nom');
              return;
            }
            
            try {
              const response = await fetch('/api/add-student', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                  name: newStudentName.trim(), 
                  franchise: newStudentFranchise 
                })
              });
              
              if (response.ok) {
                setNewStudentName('');
                await loadPlayers();
                alert('√âl√®ve ajout√© avec succ√®s !');
              } else {
                const error = await response.json();
                alert(error.error || 'Erreur lors de l\'ajout');
              }
            } catch (error) {
              alert('Erreur lors de l\'ajout de l\'√©l√®ve');
            }
          };

          // Supprimer un √©l√®ve (professeurs uniquement)
          const removeStudent = async (playerName) => {
            if (!confirm(`√ätes-vous s√ªr de vouloir supprimer ${playerName} ? Cette action est irr√©versible.`)) {
              return;
            }
            
            try {
              const response = await fetch(`/api/remove-student/${encodeURIComponent(playerName)}`, {
                method: 'DELETE'
              });
              
              if (response.ok) {
                await loadPlayers();
                alert('√âl√®ve supprim√© avec succ√®s');
              }
            } catch (error) {
              alert('Erreur lors de la suppression');
            }
          };
          
          // Drafter un √©l√®ve vers une franchise (professeurs uniquement)
          const draftStudent = async (playerName, newFranchise) => {
            if (!playerName || !newFranchise) {
              alert('Veuillez s√©lectionner un √©l√®ve et une franchise');
              return;
            }
            
            const player = players.find(p => p.name === playerName);
            if (!player) {
              alert('√âl√®ve non trouv√©');
              return;
            }
            
            if (player.franchise === newFranchise) {
              alert(`${playerName} est d√©j√† dans ${newFranchise}`);
              return;
            }
            
            if (!confirm(`Voulez-vous drafter ${playerName} (${player.score} points) vers ${newFranchise} ?`)) {
              return;
            }
            
            try {
              const response = await fetch('/api/draft-student', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                  playerName,
                  newFranchise
                })
              });
              
              if (response.ok) {
                await loadPlayers();
                alert(`${playerName} a √©t√© draft√© vers ${newFranchise} avec ses ${player.score} points !`);
              } else {
                const error = await response.json();
                alert(error.error || 'Erreur lors du draft');
              }
            } catch (error) {
              alert('Erreur lors du draft de l\'√©l√®ve');
            }
          };
          
          // Fonction pour animation de confettis sp√©ciale draft
          const triggerDraftConfetti = (franchise) => {
            const franchiseConfettiColors = {
              'Minotaurs': ['#dc2626', '#991b1b', '#fef3c7'],
              'Krakens': ['#0891b2', '#0c4a6e', '#67e8f9'],
              'Phoenix': ['#7c3aed', '#5b21b6', '#ddd6fe'],
              'Werewolves': ['#16a34a', '#15803d', '#bbf7d0'],
              'Non-Draft√©s': ['#6b7280', '#4b5563', '#f3f4f6']
            };
            
            const colors = franchiseConfettiColors[franchise] || ['#fbbf24', '#f59e0b', '#d97706'];
            
            // Confettis sp√©ciaux pour draft - plus impressionnants
            for (let i = 0; i < 5; i++) {
              setTimeout(() => {
                confetti({
                  particleCount: 150,
                  spread: 80,
                  origin: { x: Math.random(), y: 0.3 },
                  colors: colors,
                  shapes: ['star', 'circle'],
                  gravity: 0.8,
                  drift: Math.random() * 2 - 1,
                  ticks: 300
                });
              }, i * 200);
            }
            
            // Animation sp√©ciale en forme de coeur pour c√©l√©brer
            setTimeout(() => {
              confetti({
                particleCount: 100,
                startVelocity: 30,
                spread: 360,
                origin: { x: 0.5, y: 0.5 },
                colors: colors,
                shapes: ['heart', 'star'],
                gravity: 0.5,
                ticks: 400
              });
            }, 1000);
          };

          useEffect(() => {
            if (userType) {
              loadPlayers();
              const interval = setInterval(loadPlayers, 10000);
              return () => clearInterval(interval);
            }
          }, [userType]);

          // Charger les joueurs aussi pour la page student-search
          useEffect(() => {
            if (currentView === 'student-search' && players.length === 0) {
              loadPlayers();
            }
          }, [currentView]);
          
          // Appliquer le th√®me quand un joueur est trouv√©
          useEffect(() => {
            if (foundPlayer && foundPlayer.franchise) {
              applyTheme(foundPlayer.franchise);
              return () => {
                // Retirer le th√®me quand on quitte ou change
                document.documentElement.className = document.documentElement.className
                  .replace(/theme-\w+/g, '');
              };
            }
          }, [foundPlayer]);

          // Obtenir les joueurs tri√©s par score pour une franchise
          const getSortedPlayers = (franchise) => {
            return players
              .filter(player => player.franchise === franchise)
              .sort((a, b) => b.score - a.score);
          };

          // Obtenir le classement des franchises
          const getFranchiseRankings = () => {
            const franchiseScores = {};
            ['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves', 'Non-Draft√©s'].forEach(franchise => {
              franchiseScores[franchise] = players
                .filter(player => player.franchise === franchise)
                .reduce((total, player) => total + player.score, 0);
            });
            
            return Object.entries(franchiseScores)
              .sort(([,a], [,b]) => b - a)
              .map(([franchise, score], index) => ({ franchise, score, rank: index + 1 }));
          };

          // Obtenir le classement g√©n√©ral des joueurs
          const getGeneralPlayerRankings = () => {
            return [...players].sort((a, b) => b.score - a.score);
          };

          // PAGE D'ACCUEIL - CHOIX DU TYPE D'UTILISATEUR
          // Page d'accueil avec logo - remplace votre condition if (currentView === 'home')
if (currentView === 'home') {
  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 relative overflow-hidden">
      {/* Particules simplifi√©es pour mobile */}
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        {[...Array(20)].map((_, i) => (
          <div
            key={i}
            className="absolute bg-white/5 rounded-full"
            style={{
              left: `${Math.random() * 100}%`,
              top: `${Math.random() * 100}%`,
              width: `${Math.random() * 4 + 1}px`,
              height: `${Math.random() * 4 + 1}px`,
              animationDelay: `${Math.random() * 3}s`,
              animationDuration: `${Math.random() * 2 + 3}s`
            }}
          />
        ))}
      </div>

      {/* Container principal */}
      <div className="px-4 py-6 md:px-8 md:py-8 relative z-10">
        <div className="max-w-4xl mx-auto">
          
          {/* Logo centr√© */}
          <div className="text-center mb-8">
            <div className="inline-block mb-6">
              <img 
                src="/gp-basketball.png"
                alt="Gerard Philipe Basketball" 
                className="w-32 h-32 md:w-48 md:h-48 lg:w-56 lg:h-56 mx-auto drop-shadow-2xl hover:scale-105 transition-transform duration-300"
              />
            </div>
            
            {/* No Pain No Gain - Citation principale */}
            <div className="mb-6">
              <h1 className="text-4xl md:text-6xl lg:text-7xl font-black theme-text-glow mb-2 tracking-tight">
                "NO PAIN NO GAIN"
              </h1>
               <p className="text-lg md:text-xl text-white/90 font-semibold">
                Ann√©e 2025/2026
              </p>
            </div>
            
            {/* S√©lecteur de th√®me */}
            <div className="mb-6">
              <div className="flex flex-wrap justify-center gap-3 mb-4">
                <button 
                  className={`theme-button px-4 py-2 rounded-full text-sm ${!selectedFranchiseView ? 'opacity-50' : ''}`}
                  onClick={() => setSelectedFranchiseView(null)}
                >
                  üåà Th√®me Auto
                </button>
                {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].map(franchise => {
                  const avatar = getFranchiseAvatar(franchise);
                  return (
                    <button 
                      key={franchise}
                      className={`theme-button px-4 py-2 rounded-full text-sm flex items-center gap-2 ${selectedFranchiseView === franchise ? 'ring-2 ring-white' : ''}`}
                      onClick={() => handleFranchiseClick(franchise)}
                    >
                      <span className="text-lg">{avatar.emoji}</span>
                      {franchise}
                    </button>
                  );
                })}
              </div>
              {currentTheme && (
                <p className="text-sm text-white/70">
                  Th√®me actuel: {currentTheme.replace('theme-', '').charAt(0).toUpperCase() + currentTheme.replace('theme-', '').slice(1)}
                </p>
              )}
            </div>
            
            {/* Citation du jour */}
            <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4 mb-8 border border-white/20">
              <p className="text-sm text-orange-300 font-semibold mb-1">Citation du jour</p>
              <p className="text-white text-base md:text-lg italic">
                {(() => {
                  const quotes = [
                    "Hard work beats talent when talent refuses to work hard.",
                    "Every practice is a chance to get closer to your best self.",
                    "Success looks easy on game day, but it's built behind closed doors in sweat and silence.",
                    "Discipline is choosing what you want most, over what you want now.",
                    "Greatness is never given, it's earned in hours nobody sees.",
                    "Stay humble in victory, stay hungry in defeat.",
                    "The scoreboard doesn't lie, but neither does the effort you gave to get there.",
                    "Respect the game, respect your opponents, but never stop believing in your own grind.",
                    "Confidence comes from preparation, not from talking.",
                    "The best players never act like they're bigger than the team.",
                    "Champions are built from resilience, not comfort.",
                    "Failing is part of learning; quitting is not an option.",
                    "Pain is temporary, but quitting lasts forever.",
                    "Pressure is a privilege ‚Äî it means you've earned the right to compete.",
                    "If you fall ten times, stand up eleven.",
                    "Don't chase trophies, chase growth ‚Äî the trophies will follow.",
                    "Dreams don't come true without sweat as their foundation.",
                    "Your body is pulled by fatigue, but your mind decides the limit.",
                    "Leaders aren't born in the spotlight, they are forged in the unseen grind.",
                    "Believe in the work you've put in ‚Äî the results will eventually speak for you."
                  ];
                  const today = new Date().getDate();
                  return quotes[today % quotes.length];
                })()}
              </p>
            </div>
            
{/* Sous-titre explicatif */}
            <p className="text-base md:text-lg text-purple-200 mb-8 max-w-2xl mx-auto">
              section sportive basketball
            </p>
          </div>

          {/* Boutons d'acc√®s redesign√©s avec glassmorphism */}
          <div className="space-y-4 md:grid md:grid-cols-2 md:gap-6 md:space-y-0 max-w-3xl mx-auto">
            
            {/* Bouton Professeur */}
            <button
              onClick={() => setCurrentView('teacher-login')}
              className="w-full group relative overflow-hidden backdrop-blur-md bg-white/10 border border-white/20 hover:bg-white/15 active:bg-white/20 text-white rounded-2xl shadow-2xl transform active:scale-95 md:hover:scale-105 transition-all duration-300 touch-manipulation"
            >
              <div className="absolute inset-0 bg-gradient-to-r from-emerald-500/20 to-emerald-600/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
              <div className="relative z-10 p-6 md:p-8">
                <div className="flex items-center space-x-4 md:flex-col md:space-x-0 md:space-y-4">
                  <div className="text-4xl md:text-6xl flex-shrink-0 group-hover:scale-110 transition-transform duration-300">üë®‚Äçüè´</div>
                  <div className="text-left md:text-center">
                    <h2 className="text-xl md:text-3xl font-bold mb-2 text-emerald-200">PROFESSEUR</h2>
                    <p className="text-white/80 text-sm md:text-base mb-3">Gestion compl√®te du syst√®me</p>
                    <div className="inline-flex items-center bg-emerald-900/40 backdrop-blur-sm px-4 py-2 rounded-full border border-emerald-500/30">
                      <span className="text-xs md:text-sm text-emerald-300 font-semibold">üîê Acc√®s s√©curis√©</span>
                    </div>
                  </div>
                </div>
              </div>
            </button>
            
            {/* Bouton √âl√®ve */}
            <button
              onClick={() => {
                setUserType('student');
                setCurrentView('student-dashboard');
              }}
              className="w-full group relative overflow-hidden backdrop-blur-md bg-white/10 border border-white/20 hover:bg-white/15 active:bg-white/20 text-white rounded-2xl shadow-2xl transform active:scale-95 md:hover:scale-105 transition-all duration-300 touch-manipulation"
            >
              <div className="absolute inset-0 bg-gradient-to-r from-orange-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
              <div className="relative z-10 p-6 md:p-8">
                <div className="flex items-center space-x-4 md:flex-col md:space-x-0 md:space-y-4">
                  <div className="text-4xl md:text-6xl flex-shrink-0 group-hover:scale-110 transition-transform duration-300">üë®‚Äçüéì</div>
                  <div className="text-left md:text-center">
                    <h2 className="text-xl md:text-3xl font-bold mb-2 text-orange-200">√âL√àVE</h2>
                    <p className="text-white/80 text-sm md:text-base mb-3">Consultez vos performances</p>
                    <div className="inline-flex items-center bg-orange-900/40 backdrop-blur-sm px-4 py-2 rounded-full border border-orange-500/30">
                      <span className="text-xs md:text-sm text-orange-300 font-semibold">üëÅÔ∏è Acc√®s libre</span>
                    </div>
                  </div>
                </div>
              </div>
            </button>
            
          </div>

          {/* Footer discret */}
          <div className="mt-12 text-center">
            <div className="inline-flex items-center bg-white/5 backdrop-blur-sm rounded-full px-4 py-2 border border-white/10">
              <span className="text-white/60 text-xs">
                Mis √† jour: {new Date().toLocaleDateString('fr-FR')} ‚Ä¢ G√©rard Philipe Basketball
              </span>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  );
}

          // PAGE DE CONNEXION PROFESSEUR
          if (currentView === 'teacher-login') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8 flex items-center justify-center">
                <div className="bg-white/10 backdrop-blur-sm rounded-xl p-8 max-w-md w-full">
                  <h2 className="text-3xl font-bold text-white text-center mb-8">
                    üîê Connexion Professeur
                  </h2>
                  
                  <div className="space-y-6">
                    <div>
                      <label className="block text-white text-sm font-bold mb-2">
                        Nom <span className="text-red-400">*</span>
                      </label>
                      <input
                        type="text"
                        value={teacherName}
                        onChange={(e) => setTeacherName(e.target.value)}
                        className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:border-white/70 focus:outline-none"
                        placeholder="Votre nom..."
                        required
                      />
                    </div>
                    
                    <div>
                      <label className="block text-white text-sm font-bold mb-2">
                        Mot de passe *
                      </label>
                      <input
                        type="password"
                        value={password}
                        onChange={(e) => setPassword(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && verifyTeacher()}
                        className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:border-white/70 focus:outline-none"
                        placeholder="Mot de passe..."
                      />
                    </div>
                    
                    {loginError && (
                      <div className="text-red-300 text-sm text-center">
                        {loginError}
                      </div>
                    )}
                    
                    <div className="flex space-x-4">
                      <button
                        onClick={() => setCurrentView('home')}
                        className="flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg transition-colors"
                      >
                        ‚Üê Retour
                      </button>
                      <button
                        onClick={verifyTeacher}
                        className="flex-1 bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-lg transition-colors"
                      >
                        Se connecter
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // TABLEAU DE BORD PROFESSEUR
          if (currentView === 'teacher-dashboard') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">
                      üë®‚Äçüè´ Tableau de Bord Professeur
                      {teacherName && <span className="text-2xl text-purple-200"> - {teacherName}</span>}
                    </h1>
                    <button
                      onClick={() => {
                        setCurrentView('home');
                        setUserType(null);
                        setPassword('');
                        setTeacherName('');
                      }}
                      className="bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg transition-colors"
                    >
                      üö™ D√©connexion
                    </button>
                  </div>

                  {/* Affichage des √©v√©nements saisonniers actifs pour professeur */}
                  {(() => {
                    const currentSeason = getCurrentSeasonalPeriod();
                    if (currentSeason === 'christmas') {
                      return (
                        <div className="mb-6 bg-gradient-to-r from-red-600/20 to-green-600/20 border-l-4 border-red-400 p-6 rounded-lg shadow-lg">
                          <div className="flex items-start gap-3">
                            <span className="text-3xl">üéÑ</span>
                            <div className="flex-1">
                              <h3 className="text-xl font-bold text-white mb-2">üî• √âv√©nement No√´l Actif ! (15-21 d√©cembre)</h3>
                              <p className="text-white/90 leading-relaxed">
                                Badge <strong>Christmas Magic</strong> disponible : les √©l√®ves qui obtiennent 3 actions positives <strong>sans aucune action n√©gative</strong> gagneront +12 points automatiquement ! üéÑ
                              </p>
                            </div>
                          </div>
                        </div>
                      );
                    }
                    return null;
                  })()}

                  <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 md:gap-6 mb-8">
                    <button
                      onClick={() => setCurrentView('teacher-players')}
                      className="bg-gradient-to-r from-emerald-600 to-emerald-800 hover:from-emerald-500 hover:to-emerald-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üë•</div>
                      <h3 className="text-lg md:text-xl font-bold">Gestion des Points</h3>
                      <p className="text-emerald-100 text-xs md:text-sm">Ajouter/retirer des points</p>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('teacher-admin')}
                      className="bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">‚öôÔ∏è</div>
                      <h3 className="text-lg md:text-xl font-bold">Administration</h3>
                      <p className="text-blue-100 text-xs md:text-sm">G√©rer les √©l√®ves</p>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('rankings')}
                      className="bg-gradient-to-r from-amber-600 to-amber-800 hover:from-amber-500 hover:to-amber-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üèÜ</div>
                      <h3 className="text-lg md:text-xl font-bold">Classements</h3>
                      <p className="text-amber-100 text-xs md:text-sm">Voir les r√©sultats</p>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('badges')}
                      className="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üèÖ</div>
                      <h3 className="text-lg md:text-xl font-bold">Badges</h3>
                      <p className="text-purple-100 text-xs md:text-sm">Voir tous les badges</p>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('teacher-graphs')}
                      className="bg-gradient-to-r from-pink-600 to-pink-800 hover:from-pink-500 hover:to-pink-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üìä</div>
                      <h3 className="text-lg md:text-xl font-bold">Graphiques</h3>
                      <p className="text-pink-100 text-xs md:text-sm">√âvolution des scores</p>
                    </button>
                  </div>

                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 className="text-2xl font-bold text-white mb-4">üìä Statistiques Rapides</h3>
                    <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-3 md:gap-4">
                      {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves', 'Non-Draft√©s'].map(franchise => {
                        const franchisePlayers = getSortedPlayers(franchise);
                        const totalPoints = franchisePlayers.reduce((sum, player) => sum + player.score, 0);
                        const avatar = getFranchiseAvatar(franchise);
                        return (
                          <div 
                            key={franchise} 
                            className={`theme-card cursor-pointer transform transition-all duration-300 p-4 rounded-lg text-center franchise-card hover:scale-105 ${selectedFranchiseView === franchise ? 'ring-4 ring-white/50' : ''}`}
                            onClick={() => handleFranchiseClick(franchise)}
                          >
                            <div className="flex items-center justify-center mb-2">
                              <span className={`franchise-avatar ${avatar.class}`}>
                                {avatar.emoji}
                              </span>
                            </div>
                            <h4 className="font-bold theme-text-glow text-lg">{franchise}</h4>
                            <div className="text-3xl font-bold theme-text-glow">{totalPoints}</div>
                            <div className="text-sm opacity-80">{franchisePlayers.length} √©l√®ves</div>
                            {selectedFranchiseView === franchise && (
                              <div className="mt-2 text-xs text-center opacity-75">
                                üé® Th√®me actif
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // GESTION DES POINTS PROFESSEUR
          if (currentView === 'teacher-players') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4 md:p-8">
                <div className="max-w-7xl mx-auto">
                  <div className="flex justify-between items-center mb-6">
                    <h1 className="text-2xl md:text-4xl font-bold text-white">üë• Gestion des Points</h1>
                    <div className="flex space-x-2 md:space-x-4">
                      {loading && <div className="text-white text-sm md:text-base">‚è≥ Chargement...</div>}
                      <button
                        onClick={() => setCurrentView('teacher-dashboard')}
                        className="bg-gray-600 hover:bg-gray-500 text-white px-3 md:px-6 py-2 md:py-3 rounded-lg transition-colors text-sm md:text-base"
                      >
                        ‚Üê Retour
                      </button>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 md:gap-6">
                    {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves', 'Non-Draft√©s'].map(franchise => {
                      const avatar = getFranchiseAvatar(franchise);
                      return (
                        <div key={franchise} className="bg-white/10 backdrop-blur-sm rounded-xl p-4 md:p-6 franchise-card">
                          <h2 className={`text-lg md:text-2xl font-bold text-white mb-4 text-center bg-gradient-to-r ${franchiseColors[franchise]} p-2 md:p-3 rounded-lg flex items-center justify-center space-x-2`}>
                            <span className={`franchise-avatar ${avatar.class} text-2xl md:text-3xl`}>
                              {avatar.emoji}
                            </span>
                            <span className="text-sm md:text-base">{franchise}</span>
                          </h2>
                          <div className="space-y-3">
                            {getSortedPlayers(franchise).map(player => (
                              <div key={player.name} className="bg-white/20 rounded-lg p-3">
                                <div className="flex justify-between items-center mb-2">
                                  <button
                                    onClick={() => loadPlayerHistory(player.name)}
                                    className="text-white font-semibold hover:text-yellow-300 transition-colors flex items-center space-x-1 text-sm md:text-base"
                                  >
                                    <span className="truncate max-w-24 md:max-w-none">{player.name}</span>
                                    <span>üìã</span>
                                  </button>
                                  <div className="flex items-center space-x-2">
                                    <div className="flex items-center space-x-1">
                                      <span className="text-xl md:text-2xl">
                                        {getBadge(player.score).emoji}
                                      </span>
                                      <span className="text-white font-bold text-sm md:text-base">
                                        {player.score}
                                      </span>
                                    </div>
                                    <button
                                      onClick={() => undoLastAction(player.name)}
                                      className="bg-red-500 hover:bg-red-400 text-white px-2 py-1 rounded text-xs"
                                      title="Annuler derni√®re action"
                                    >
                                      ‚Ü∫
                                    </button>
                                  </div>
                                </div>
                                <BadgeDisplay badges={player.badges || []} />
                                <button
                                  onClick={() => {
                                    setSelectedStudent(player.name);
                                    setCurrentView('teacher-actions');
                                  }}
                                  className="w-full bg-blue-600 hover:bg-blue-500 text-white px-3 py-2 rounded transition-colors font-semibold text-sm md:text-base"
                                  disabled={loading}
                                >
                                  Attribuer des Points
                                </button>
                              </div>
                            ))}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            );
          }

         // PAGE D'ATTRIBUTION DES POINTS
if (currentView === 'teacher-actions') {
  const selectedPlayerData = players.find(p => p.name === selectedStudent);
  if (!selectedPlayerData) return null;

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4">
      <div className="max-w-4xl mx-auto">
        {/* En-t√™te */}
        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4 md:p-6 mb-6">
          <div className="flex justify-between items-center mb-4">
            <button
              onClick={() => setCurrentView('teacher-players')}
              className="bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg transition-colors text-sm md:text-base"
            >
              ‚Üê Retour
            </button>
            {loading && <div className="text-white text-sm">‚è≥ Attribution...</div>}
          </div>
          
          <div className="text-center">
            <div className={`bg-gradient-to-r ${franchiseColors[selectedPlayerData.franchise]} p-4 rounded-lg inline-block mb-4`}>
              <div className="flex items-center space-x-3">
                <span className={`${getFranchiseAvatar(selectedPlayerData.franchise).class} text-3xl md:text-4xl`}>
                  {getFranchiseAvatar(selectedPlayerData.franchise).emoji}
                </span>
                <div className="text-left">
                  <h1 className="text-2xl md:text-3xl font-bold text-white">{selectedPlayerData.name}</h1>
                  <p className="text-white/90">{selectedPlayerData.franchise}</p>
                </div>
              </div>
            </div>
            
            <div className="flex justify-center items-center space-x-3 mb-2">
              <span className="text-3xl">{getBadge(selectedPlayerData.score).emoji}</span>
              <span className="text-2xl font-bold text-white">{selectedPlayerData.score} points</span>
            </div>
            <div className="text-lg text-yellow-300 font-semibold">
              {getBadge(selectedPlayerData.score).name}
            </div>
          </div>
        </div>

        {/* Actions positives */}
        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4 md:p-6 mb-6">
          <h2 className="text-xl md:text-2xl font-bold text-green-400 mb-4 text-center">
            ‚úÖ Actions Positives
          </h2>
          
          {/* Actions Acad√©miques Positives */}
          <div className="mb-4">
            <h3 className="text-lg font-semibold text-blue-300 mb-3 flex items-center">
              <span className="mr-2">üìö</span> Acad√©mique
            </h3>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
              {positiveActions.filter(action => action.category === 'academic').map((action, index) => (
                <button
                  key={`pos-academic-${index}`}
                  onClick={() => {
                    addPoints(selectedPlayerData.name, action.points, action.label);
                    setCurrentView('teacher-players');
                  }}
                  className="bg-blue-600/80 hover:bg-blue-500 text-white p-4 md:p-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg min-h-[60px] md:min-h-0 touch-manipulation"
                  disabled={loading}
                >
                  <div className="flex justify-between items-center">
                    <span className="text-left text-sm md:text-base font-medium leading-tight">
                      {action.label.replace(/^üìö/, '').trim()}
                    </span>
                    <span className="text-blue-200 font-bold text-lg">
                      +{action.points}
                    </span>
                  </div>
                </button>
              ))}
            </div>
          </div>

          {/* Actions Sport Positives */}
          <div>
            <h3 className="text-lg font-semibold text-orange-300 mb-3 flex items-center">
              <span className="mr-2">üèÄ</span> Sport
            </h3>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
              {positiveActions.filter(action => action.category === 'sport').map((action, index) => (
                <button
                  key={`pos-sport-${index}`}
                  onClick={() => {
                    addPoints(selectedPlayerData.name, action.points, action.label);
                    setCurrentView('teacher-players');
                  }}
                  className="bg-green-600/80 hover:bg-green-500 text-white p-4 md:p-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg min-h-[60px] md:min-h-0 touch-manipulation"
                  disabled={loading}
                >
                  <div className="flex justify-between items-center">
                    <span className="text-left text-sm md:text-base font-medium leading-tight">
                      {action.label.replace(/^üèÄ/, '').trim()}
                    </span>
                    <span className="text-green-200 font-bold text-lg">
                      +{action.points}
                    </span>
                  </div>
                </button>
              ))}
            </div>
          </div>
        </div>

        {/* Actions n√©gatives */}
        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4 md:p-6">
          <h2 className="text-xl md:text-2xl font-bold text-red-400 mb-4 text-center">
            ‚õî Actions N√©gatives
          </h2>
          
          {/* Actions Acad√©miques N√©gatives */}
          <div className="mb-4">
            <h3 className="text-lg font-semibold text-pink-300 mb-3 flex items-center">
              <span className="mr-2">üìö</span> Acad√©mique
            </h3>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
              {negativeActions.filter(action => action.category === 'academic').map((action, index) => (
                <button
                  key={`neg-academic-${index}`}
                  onClick={() => {
                    addPoints(selectedPlayerData.name, action.points, action.label);
                    setCurrentView('teacher-players');
                  }}
                  className="bg-pink-600/80 hover:bg-pink-500 text-white p-4 md:p-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg min-h-[60px] md:min-h-0 touch-manipulation"
                  disabled={loading}
                >
                  <div className="flex justify-between items-center">
                    <span className="text-left text-sm md:text-base font-medium leading-tight">
                      {action.label}
                    </span>
                    <span className="text-pink-200 font-bold text-lg">
                      {action.points}
                    </span>
                  </div>
                </button>
              ))}
            </div>
          </div>

          {/* Actions Sport N√©gatives */}
          <div>
            <h3 className="text-lg font-semibold text-red-300 mb-3 flex items-center">
              <span className="mr-2">üèÄ</span> Sport
            </h3>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
              {negativeActions.filter(action => action.category === 'sport').map((action, index) => (
                <button
                  key={`neg-sport-${index}`}
                  onClick={() => {
                    addPoints(selectedPlayerData.name, action.points, action.label);
                    setCurrentView('teacher-players');
                  }}
                  className="bg-red-600/80 hover:bg-red-500 text-white p-4 md:p-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg min-h-[60px] md:min-h-0 touch-manipulation"
                  disabled={loading}
                >
                  <div className="flex justify-between items-center">
                    <span className="text-left text-sm md:text-base font-medium leading-tight">
                      {action.label}
                    </span>
                    <span className="text-red-200 font-bold text-lg">
                      {action.points}
                    </span>
                  </div>
                </button>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
          
          // ADMINISTRATION PROFESSEUR
          if (currentView === 'teacher-admin') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">‚öôÔ∏è Administration des √âl√®ves</h1>
                    <button
                      onClick={() => setCurrentView('teacher-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
                    >
                      ‚Üê Retour Tableau de Bord
                    </button>
                  </div>

                  {/* Espace pour message personnalis√© */}
                  <div className="mb-6">
                    <div className="theme-card p-4 rounded-xl border-2 border-dashed border-white/30 hover:border-white/50 transition-all duration-300">
                      <div className="flex items-center gap-3 mb-3">
                        <span className="text-2xl">üí¨</span>
                        <h3 className="text-lg font-semibold text-white">Message du jour</h3>
                      </div>
                      
                      {studentPageMessage ? (
                        <div className="bg-white/10 rounded-lg p-4 mb-3">
                          <p className="text-white text-sm leading-relaxed whitespace-pre-wrap">
                            {studentPageMessage}
                          </p>
                          <button 
                            onClick={() => setStudentPageMessage('')}
                            className="text-red-300 hover:text-red-100 text-xs mt-2 underline"
                          >
                            Effacer le message
                          </button>
                        </div>
                      ) : (
                        <p className="text-white/70 text-sm italic mb-3">
                          Aucun message configur√© pour le moment
                        </p>
                      )}
                      
                      <div className="flex gap-2">
                        <textarea
                          placeholder="√âcrivez votre message ici... (instructions, rappels, informations importantes)"
                          className="flex-1 px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/60 border border-white/30 focus:border-white/70 focus:outline-none text-sm resize-none"
                          rows="2"
                          value={studentPageMessage}
                          onChange={(e) => setStudentPageMessage(e.target.value)}
                        />
                        <button
                          onClick={() => {
                            // Le message est d√©j√† mis √† jour via onChange
                            if (studentPageMessage.trim()) {
                              alert('Message mis √† jour !');
                            }
                          }}
                          className="theme-button px-4 py-2 rounded-lg text-sm whitespace-nowrap"
                        >
                          ‚úÖ Publier
                        </button>
                      </div>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">
                        ‚ûï Ajouter un √âl√®ve
                      </h2>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            Nom de l'√©l√®ve
                          </label>
                          <input
                            type="text"
                            value={newStudentName}
                            onChange={(e) => setNewStudentName(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:border-white/70 focus:outline-none"
                            placeholder="Pr√©nom Nom..."
                          />
                        </div>
                        
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            Franchise
                          </label>
                          <select
                            value={newStudentFranchise}
                            onChange={(e) => setNewStudentFranchise(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:border-white/70 focus:outline-none"
                          >
                            <option value="Non-Draft√©s" className="text-black">‚ú® Non-Draft√©s</option>
                            <option value="Minotaurs" className="text-black">üêÇ Minotaurs</option>
                            <option value="Krakens" className="text-black">üêô Krakens</option>
                            <option value="Phoenix" className="text-black">üî• Phoenix</option>
                            <option value="Werewolves" className="text-black">üê∫ Werewolves</option>
                          </select>
                        </div>
                        
                        <button
                          onClick={addStudent}
                          className="w-full bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg transition-colors font-bold"
                        >
                          ‚ûï Ajouter l'√âl√®ve
                        </button>
                      </div>
                    </div>

                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">
                        ‚úèÔ∏è Renommer un √âl√®ve
                      </h2>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            Nom actuel de l'√©l√®ve
                          </label>
                          <select
                            value={renamePlayerName}
                            onChange={(e) => setRenamePlayerName(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:border-white/70 focus:outline-none"
                          >
                            <option value="" className="text-black">S√©lectionner un √©l√®ve...</option>
                            {players.map(player => (
                              <option key={player.name} value={player.name} className="text-black">
                                {player.name} ({player.franchise})
                              </option>
                            ))}
                          </select>
                        </div>
                        
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            Nouveau nom
                          </label>
                          <input
                            type="text"
                            placeholder="Nouveau nom de l'√©l√®ve"
                            value={newPlayerName}
                            onChange={(e) => setNewPlayerName(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/60 border border-white/30 focus:border-white/70 focus:outline-none"
                          />
                        </div>
                        
                        <button
                          onClick={handleRenameStudent}
                          className="w-full bg-orange-600 hover:bg-orange-500 text-white py-3 rounded-lg transition-colors font-bold"
                        >
                          ‚úèÔ∏è Renommer l'√âl√®ve
                        </button>
                      </div>
                    </div>

                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">
                        üóëÔ∏è Supprimer un √âl√®ve
                      </h2>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            S√©lectionner un √©l√®ve
                          </label>
                          <select
                            value={selectedStudent}
                            onChange={(e) => setSelectedStudent(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:border-white/70 focus:outline-none"
                          >
                            <option value="" className="text-black">-- Choisir un √©l√®ve --</option>
                            {players
                              .sort((a, b) => a.name.localeCompare(b.name))
                              .map(player => (
                                <option key={player.name} value={player.name} className="text-black">
                                  {player.name} ({player.franchise})
                                </option>
                              ))}
                          </select>
                        </div>
                        
                        <button
                          onClick={() => selectedStudent && removeStudent(selectedStudent)}
                          disabled={!selectedStudent}
                          className="w-full bg-red-600 hover:bg-red-500 disabled:bg-gray-500 disabled:cursor-not-allowed text-white py-3 rounded-lg transition-colors font-bold"
                        >
                          üóëÔ∏è Supprimer l'√âl√®ve
                        </button>
                        
                        <p className="text-red-300 text-sm text-center">
                          ‚ö†Ô∏è Cette action est irr√©versible !
                        </p>
                      </div>
                    </div>
                    
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">
                        üéØ Drafter un √âl√®ve
                      </h2>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            √âl√®ve √† drafter (Non-Draft√©s uniquement)
                          </label>
                          <select
                            value={selectedStudentForDraft}
                            onChange={(e) => setSelectedStudentForDraft(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:border-white/70 focus:outline-none"
                          >
                            <option value="" className="text-black">-- Choisir un √©l√®ve non-draft√© --</option>
                            {players
                              .filter(player => player.franchise === 'Non-Draft√©s')
                              .sort((a, b) => b.score - a.score)
                              .map(player => (
                                <option key={player.name} value={player.name} className="text-black">
                                  {player.name} ({player.score} points)
                                </option>
                              ))}
                          </select>
                        </div>
                        
                        <div>
                          <label className="block text-white text-sm font-bold mb-2">
                            Franchise de destination
                          </label>
                          <select
                            value={draftFranchise}
                            onChange={(e) => setDraftFranchise(e.target.value)}
                            className="w-full px-3 py-2 rounded-lg bg-white/20 text-white border border-white/30 focus:border-white/70 focus:outline-none"
                          >
                            <option value="" className="text-black">-- Choisir une franchise --</option>
                            <option value="Minotaurs" className="text-black">üêÇ Minotaurs</option>
                            <option value="Krakens" className="text-black">üêô Krakens</option>
                            <option value="Phoenix" className="text-black">üî• Phoenix</option>
                            <option value="Werewolves" className="text-black">üê∫ Werewolves</option>
                          </select>
                        </div>
                        
                        <button
                          onClick={() => draftStudent(selectedStudentForDraft, draftFranchise)}
                          disabled={!selectedStudentForDraft || !draftFranchise || draftFranchise === 'Non-Draft√©s'}
                          className="w-full bg-purple-600 hover:bg-purple-500 disabled:bg-gray-500 disabled:cursor-not-allowed text-white py-3 rounded-lg transition-colors font-bold"
                        >
                          üéØ Drafter l'√âl√®ve
                        </button>
                        
                        <p className="text-purple-300 text-sm text-center">
                          üí° Les points de l'√©l√®ve seront transf√©r√©s √† sa nouvelle franchise
                        </p>
                      </div>
                    </div>
                  </div>

                  <div className="mt-8 bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h2 className="text-2xl font-bold text-white mb-6 text-center">
                      üìã Liste Actuelle des √âl√®ves
                    </h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                      {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves', 'Non-Draft√©s'].map(franchise => {
                        const avatar = getFranchiseAvatar(franchise);
                        return (
                          <div key={franchise} className={`bg-gradient-to-r ${franchiseColors[franchise]} p-4 rounded-lg franchise-card`}>
                            <div className="flex items-center justify-center mb-3">
                              <span className={`franchise-avatar ${avatar.class}`}>
                                {avatar.emoji}
                              </span>
                              <h3 className="text-xl font-bold text-white ml-2">{franchise}</h3>
                            </div>
                            <div className="space-y-2">
                              {getSortedPlayers(franchise).map(player => (
                                <div key={player.name} className="bg-white/20 p-2 rounded text-white text-sm">
                                  <div className="flex justify-between items-center">
                                    <span>{player.name}</span>
                                    <span className="font-bold">{player.score} pts</span>
                                  </div>
                                </div>
                              ))}
                            </div>
                            <div className="text-center mt-3 text-white/80 text-sm">
                              {getSortedPlayers(franchise).length} √©l√®ve(s)
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>

                  <div className="mt-8 bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h2 className="text-2xl font-bold text-white mb-6 text-center">
                      üîê Codes d'Acc√®s des √âl√®ves
                    </h2>
                    <div className="space-y-4">
                      <div className="bg-blue-500/20 border border-blue-400/30 rounded-lg p-4">
                        <div className="flex items-start gap-3">
                          <span className="text-2xl">üí°</span>
                          <div className="text-white text-sm">
                            <p className="font-semibold mb-1">Information importante</p>
                            <p>Chaque √©l√®ve poss√®de un code d'acc√®s unique pour acc√©der √† sa section "Mon Score". Ces codes sont g√©n√©r√©s automatiquement et restent constants.</p>
                          </div>
                        </div>
                      </div>
                      
                      {/* Bouton pour charger les codes */}
                      {studentCodes.length === 0 && !loadingCodes && (
                        <div className="text-center py-8">
                          <button
                            onClick={() => {
                              console.log('Bouton cliqu√© - Chargement des codes...');
                              loadStudentCodes();
                            }}
                            className="bg-blue-600 hover:bg-blue-500 text-white px-8 py-4 rounded-lg transition-colors text-lg font-bold"
                          >
                            üîê Charger les codes d'acc√®s
                          </button>
                          <p className="text-white/70 text-sm mt-4">
                            Cliquez pour afficher tous les codes d'acc√®s des √©l√®ves
                          </p>
                        </div>
                      )}

                      {/* √âtat de chargement */}
                      {loadingCodes && (
                        <div className="text-center py-8">
                          <div className="text-white text-lg">‚è≥ Chargement des codes d'acc√®s...</div>
                          <div className="text-white/60 text-sm mt-2">Veuillez patienter</div>
                        </div>
                      )}

                      {/* Affichage des codes */}
                      {studentCodes.length > 0 && !loadingCodes && (
                        <>
                          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto mb-6">
                            {studentCodes.map(student => {
                              const avatar = getFranchiseAvatar(student.franchise);
                              
                              return (
                                <div key={student.name} className="bg-white/10 rounded-lg p-3">
                                  <div className="flex items-center gap-3 mb-2">
                                    <span className={`franchise-avatar ${avatar.class} text-xl`}>
                                      {avatar.emoji}
                                    </span>
                                    <div className="flex-1 min-w-0">
                                      <div className="text-white font-medium text-sm truncate">
                                        {student.name}
                                      </div>
                                      <div className="text-white/60 text-xs">
                                        {student.franchise}
                                      </div>
                                    </div>
                                  </div>
                                  <div className="bg-black/20 rounded p-2 text-center">
                                    <div className="text-white font-mono text-lg tracking-wider">
                                      {student.code}
                                    </div>
                                    <button
                                      onClick={() => {
                                        navigator.clipboard.writeText(student.code);
                                        alert(`Code copi√©: ${student.code}`);
                                      }}
                                      className="text-blue-300 hover:text-blue-100 text-xs mt-1 underline"
                                    >
                                      Copier
                                    </button>
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                          
                          <div className="text-center">
                            <button
                              onClick={() => {
                                const codes = studentCodes.map(student => 
                                  `${student.name}: ${student.code}`
                                ).join('\n');
                                
                                navigator.clipboard.writeText(codes);
                                alert('Tous les codes ont √©t√© copi√©s dans le presse-papier !');
                              }}
                              className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg transition-colors mr-4"
                            >
                              üìã Copier tous les codes
                            </button>
                            <button
                              onClick={() => {
                                console.log('Actualisation des codes...');
                                loadStudentCodes();
                              }}
                              className="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg transition-colors"
                            >
                              üîÑ Actualiser
                            </button>
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  <div className="mt-8 bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h2 className="text-2xl font-bold text-white mb-6 text-center">
                      üìä Export des Donn√©es
                    </h2>
                    <div className="flex justify-center">
                      <button
                        onClick={() => {
                          const link = document.createElement('a');
                          link.href = '/api/export-csv';
                          link.download = `export_basketball_${new Date().toISOString().split('T')[0]}.csv`;
                          document.body.appendChild(link);
                          link.click();
                          document.body.removeChild(link);
                        }}
                        className="bg-gradient-to-r from-green-600 to-green-800 hover:from-green-500 hover:to-green-700 text-white px-8 py-4 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-xl flex items-center space-x-3"
                      >
                        <span className="text-2xl">üíæ</span>
                        <div>
                          <div className="font-bold text-lg">Exporter en CSV</div>
                          <div className="text-sm text-green-100">T√©l√©charger toutes les donn√©es</div>
                        </div>
                      </button>
                    </div>
                    <p className="text-center text-white/70 mt-4 text-sm">
                      Exporte les points, franchises et badges au format CSV pour Excel
                    </p>
                  </div>
                </div>
              </div>
            );
          }

          // VUE GRAPHIQUES PROFESSEUR
          if (currentView === 'teacher-graphs') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-7xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üìä √âvolution des Scores</h1>
                    <button
                      onClick={() => setCurrentView('teacher-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
                    >
                      ‚Üê Retour Tableau de Bord
                    </button>
                  </div>

                  <div className="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    {/* Liste des joueurs */}
                    {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves', 'Non-Draft√©s'].map(franchise => {
                      const franchisePlayers = getSortedPlayers(franchise);
                      const avatar = getFranchiseAvatar(franchise);
                      return (
                        <div key={franchise} className={`bg-gradient-to-r ${franchiseColors[franchise]} rounded-xl p-6 franchise-card`}>
                          <div className="flex items-center justify-center mb-4">
                            <span className={`franchise-avatar ${avatar.class}`}>
                              {avatar.emoji}
                            </span>
                            <h3 className="text-xl font-bold text-white ml-2">{franchise}</h3>
                          </div>
                          <div className="space-y-2">
                            {franchisePlayers.map(player => (
                              <button
                                key={player.name}
                                onClick={() => {
                                  setSelectedPlayerForGraph(player.name);
                                  loadPlayerProgression(player.name);
                                }}
                                className={`w-full p-3 rounded-lg transition-all duration-200 text-left ${
                                  selectedPlayerForGraph === player.name 
                                    ? 'bg-white text-gray-800 shadow-lg transform scale-105' 
                                    : 'bg-white/20 text-white hover:bg-white/30'
                                }`}
                              >
                                <div className="flex justify-between items-center">
                                  <span className="font-medium">{player.name}</span>
                                  <span className="font-bold">{player.score} pts</span>
                                </div>
                              </button>
                            ))}
                          </div>
                        </div>
                      );
                    })}
                  </div>

                  {/* Graphique du joueur s√©lectionn√© */}
                  {selectedPlayerForGraph && (
                    <div className="mt-8 bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">
                        üìà √âvolution de {selectedPlayerForGraph}
                      </h2>
                      <div className="bg-white rounded-lg p-4">
                        <div className="chart-container">
                          <canvas id="playerChart"></canvas>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          // TABLEAU DE BORD √âL√àVE
          if (currentView === 'student-dashboard') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4 md:p-8">
                <div className="max-w-4xl mx-auto">
                  <div className="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4 sm:gap-0">
                    <h1 className="text-2xl sm:text-4xl font-bold text-white text-center sm:text-left">üë®‚Äçüéì Espace √âl√®ve</h1>
                    <button
                      onClick={() => {
                        setCurrentView('home');
                        setUserType(null);
                      }}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-4 py-3 md:px-6 md:py-3 rounded-lg transition-colors min-h-12 flex items-center justify-center text-sm md:text-base"
                    >
                      ‚Üê Retour Accueil
                    </button>
                  </div>


                  {/* Affichage du message du jour s'il existe */}
                  {studentPageMessage && (
                    <div className="mb-6 bg-gradient-to-r from-green-500/20 to-blue-500/20 border-l-4 border-green-400 p-6 rounded-lg shadow-lg">
                      <div className="flex items-start gap-3">
                        <span className="text-3xl">üì¢</span>
                        <div className="flex-1">
                          <h3 className="text-xl font-bold text-white mb-2">Message du jour</h3>
                          <p className="text-white/90 text-lg leading-relaxed">
                            {studentPageMessage}
                          </p>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Affichage des √©v√©nements saisonniers actifs */}
                  {(() => {
                    const currentSeason = getCurrentSeasonalPeriod();
                    if (currentSeason === 'christmas') {
                      return (
                        <div className="mb-6 bg-gradient-to-r from-red-600/20 to-green-600/20 border-l-4 border-red-400 p-6 rounded-lg shadow-lg">
                          <div className="flex items-start gap-3">
                            <span className="text-3xl">üéÑ</span>
                            <div className="flex-1">
                              <h3 className="text-xl font-bold text-white mb-2">üî• √âv√©nement No√´l Actif !</h3>
                              <p className="text-white/90 text-lg leading-relaxed">
                                Du 15 au 21 d√©cembre ‚Ä¢ Obtenez 3 actions positives <strong>sans aucune action n√©gative</strong> pour d√©bloquer le badge <strong>Christmas Magic</strong> (+12 points) ! üéÑ
                              </p>
                            </div>
                          </div>
                        </div>
                      );
                    }
                    return null;
                  })()}


                  <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 md:gap-6 mb-8">
                    <button
                      onClick={() => {
                        setCurrentView('student-search');
                        // R√©initialiser la recherche quand on clique sur "Mon Score"
                        setSearchName('');
                        setFoundPlayer(null);
                        setSearchHistory([]);
                      }}
                      className="bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üîç</div>
                      <h3 className="text-lg md:text-xl font-bold">Mon Score</h3>
                      <p className="text-blue-100 text-xs md:text-sm">Voir mon historique personnel</p>
                    </button>

                    <button
                      onClick={() => setCurrentView('badges')}
                      className="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üèÖ</div>
                      <h3 className="text-lg md:text-xl font-bold">Badges</h3>
                      <p className="text-purple-100 text-xs md:text-sm">D√©couvrir les badges</p>
                    </button>

                    <button
                      onClick={() => setCurrentView('grades')}
                      className="bg-gradient-to-r from-orange-600 to-orange-800 hover:from-orange-500 hover:to-orange-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üèÄ</div>
                      <h3 className="text-lg md:text-xl font-bold">Grades</h3>
                      <p className="text-orange-100 text-xs md:text-sm">D√©couvrir les grades</p>
                    </button>

                    <button
                      onClick={() => setCurrentView('rankings')}
                      className="bg-gradient-to-r from-amber-600 to-amber-800 hover:from-amber-500 hover:to-amber-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üèÜ</div>
                      <h3 className="text-lg md:text-xl font-bold">Classement</h3>
                      <p className="text-amber-100 text-xs md:text-sm">Voir les r√©sultats</p>
                    </button>

                    <button
                      onClick={() => setCurrentView('guide')}
                      className="bg-gradient-to-r from-teal-600 to-teal-800 hover:from-teal-500 hover:to-teal-700 text-white p-4 md:p-6 rounded-xl shadow-2xl transform hover:scale-105 active:scale-95 transition-all duration-300 touch-manipulation min-h-20 md:min-h-24"
                    >
                      <div className="text-3xl md:text-4xl mb-2">üìö</div>
                      <h3 className="text-lg md:text-xl font-bold">Guide</h3>
                      <p className="text-teal-100 text-xs md:text-sm">Comment √ßa marche ?</p>
                    </button>
                    
                  </div>

                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 className="text-2xl font-bold text-white mb-6 text-center">
                      üè† Les Quatre Franchises
                    </h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].map(franchise => {
                        const franchisePlayers = getSortedPlayers(franchise);
                        const totalPoints = franchisePlayers.reduce((sum, player) => sum + player.score, 0);
                        const avatar = getFranchiseAvatar(franchise);
                        return (
                          <div 
                            key={franchise} 
                            className={`theme-card cursor-pointer transform transition-all duration-300 p-4 rounded-lg text-center franchise-card hover:scale-105 ${selectedFranchiseView === franchise ? 'ring-4 ring-white/50' : ''}`}
                            onClick={() => handleFranchiseClick(franchise)}
                          >
                            <div className="flex items-center justify-center mb-2">
                              <span className={`franchise-avatar ${avatar.class}`}>
                                {avatar.emoji}
                              </span>
                            </div>
                            <h4 className="font-bold theme-text-glow text-lg">{franchise}</h4>
                            <div className="text-3xl font-bold theme-text-glow">{totalPoints}</div>
                            <div className="text-sm opacity-80">{franchisePlayers.length} √©l√®ves</div>
                            {selectedFranchiseView === franchise && (
                              <div className="mt-2 text-xs text-center opacity-75">
                                üé® Th√®me actif
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // RECHERCHE √âL√àVE
          if (currentView === 'student-search') {
            
            // Filtrer les joueurs en fonction de la recherche (avec gestion des accents)
            const normalizeString = (str) => {
              return str.toLowerCase()
                        .normalize('NFD')
                        .replace(/[\u0300-\u036f]/g, ''); // Supprime les accents
            };
            
            const filteredPlayers = players.filter(player => {
              const normalizedPlayerName = normalizeString(player.name);
              const normalizedSearchName = normalizeString(searchName);
              return normalizedPlayerName.includes(normalizedSearchName);
            });


            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-4xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üîç Rechercher Mon Score</h1>
                    <button
                      onClick={() => setCurrentView('student-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-4 py-3 md:px-6 md:py-3 rounded-lg transition-colors min-h-[44px] md:min-h-12 text-sm md:text-base touch-manipulation"
                    >
                      ‚Üê Retour
                    </button>
                  </div>

                  <div className="theme-card p-6 mb-8">
                    <h2 className="text-2xl font-bold theme-text-glow mb-6 text-center">
                      üîç Trouvez votre profil
                    </h2>
                    
                    {/* Barre de recherche am√©lior√©e */}
                    <div className="relative mb-4">
                      <div className="flex space-x-4">
                        <div className="flex-1 relative">
                          <input
                            type="text"
                            value={searchName}
                            onChange={(e) => {
                              setSearchName(e.target.value);
                              // R√©initialiser foundPlayer si l'utilisateur modifie la recherche
                              if (foundPlayer && e.target.value !== foundPlayer.name) {
                                setFoundPlayer(null);
                                setSearchHistory([]);
                              }
                            }}
                            onKeyPress={(e) => e.key === 'Enter' && searchPlayer()}
                            className="w-full px-4 py-4 md:py-3 pl-12 md:pl-12 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:border-white/70 focus:outline-none text-lg md:text-lg min-h-14 md:min-h-12"
                            placeholder="Tapez votre pr√©nom ou nom..."
                          />
                          <span className="absolute left-4 top-1/2 transform -translate-y-1/2 text-white/60 text-xl">
                            üë§
                          </span>
                        </div>
                        <button
                          onClick={() => searchPlayer()}
                          className="theme-button px-6 py-4 md:px-8 md:py-3 rounded-lg font-bold flex items-center gap-2 min-h-14 md:min-h-12 text-sm md:text-base"
                        >
                          üîç Rechercher
                        </button>
                      </div>
                    </div>

                    {/* Suggestions de recherche */}
                    {searchName && searchName.length > 0 && filteredPlayers.length > 0 && (!foundPlayer || searchName !== foundPlayer.name) && (
                      <div className="bg-white/10 rounded-lg p-4 mb-4">
                        <h3 className="text-white font-semibold mb-3 flex items-center gap-2">
                          üí° Suggestions ({filteredPlayers.length})
                        </h3>
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-40 overflow-y-auto">
                          {filteredPlayers.slice(0, 9).map(player => {
                            const avatar = getFranchiseAvatar(player.franchise);
                            return (
                              <button
                                key={player.id}
                                onClick={() => searchPlayer(player.name)}
                                className="flex items-center gap-3 p-3 rounded-lg bg-white/10 hover:bg-white/20 transition-all duration-200 text-left group"
                              >
                                <span className={`franchise-avatar ${avatar.class} text-2xl`}>
                                  {avatar.emoji}
                                </span>
                                <div className="flex-1 min-w-0">
                                  <div className="text-white font-medium text-sm group-hover:text-blue-200 truncate">
                                    {player.name}
                                  </div>
                                  <div className="text-white/60 text-xs">
                                    {player.franchise} ‚Ä¢ {player.score} pts
                                  </div>
                                </div>
                              </button>
                            );
                          })}
                        </div>
                        {filteredPlayers.length > 9 && (
                          <p className="text-white/60 text-xs mt-2 text-center">
                            +{filteredPlayers.length - 9} autres r√©sultats...
                          </p>
                        )}
                      </div>
                    )}

                    {/* Navigation rapide par franchise */}
                    <div className="grid grid-cols-2 lg:grid-cols-4 gap-3">
                      {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].map(franchise => {
                        const franchisePlayers = players.filter(p => p.franchise === franchise);
                        const avatar = getFranchiseAvatar(franchise);
                        return (
                          <div key={franchise} className="bg-white/5 rounded-lg p-3 text-center">
                            <div className="flex items-center justify-center mb-2">
                              <span className={`franchise-avatar ${avatar.class} text-3xl`}>
                                {avatar.emoji}
                              </span>
                            </div>
                            <div className="text-white font-semibold text-sm mb-1">{franchise}</div>
                            <div className="text-white/60 text-xs">{franchisePlayers.length} √©l√®ves</div>
                          </div>
                        );
                      })}
                    </div>

                    {/* Interface de saisie du code d'acc√®s */}
                    {showCodeInput && (
                      <div className="bg-orange-500/20 border border-orange-400/30 rounded-lg p-6 mt-4">
                        <div className="text-center mb-4">
                          <span className="text-4xl">üîê</span>
                          <h3 className="text-xl font-bold text-white mt-2">Code d'acc√®s requis</h3>
                          <p className="text-white/80 text-sm mt-1">
                            Pour acc√©der au profil de <strong>{pendingPlayerName}</strong>
                          </p>
                        </div>
                        
                        <div className="space-y-4">
                          <div className="relative">
                            <input
                              type="text"
                              value={accessCode}
                              onChange={(e) => setAccessCode(e.target.value.toUpperCase())}
                              onKeyPress={(e) => e.key === 'Enter' && submitAccessCode()}
                              className="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:border-white/70 focus:outline-none text-center text-lg font-mono tracking-wider"
                              placeholder="XXX-XXX"
                              maxLength="7"
                            />
                            <span className="absolute right-4 top-1/2 transform -translate-y-1/2 text-white/60">
                              üîë
                            </span>
                          </div>
                          
                          <div className="flex gap-3">
                            <button
                              onClick={submitAccessCode}
                              className="flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg font-bold transition-colors"
                            >
                              ‚úÖ Valider
                            </button>
                            <button
                              onClick={cancelCodeInput}
                              className="flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg font-bold transition-colors"
                            >
                              üîç Nouvelle recherche
                            </button>
                          </div>
                          
                          <div className="bg-yellow-500/20 border border-yellow-400/30 rounded-lg p-3">
                            <div className="flex items-start gap-2">
                              <span className="text-lg">‚ö†Ô∏è</span>
                              <div className="text-yellow-200 text-xs">
                                <p className="font-semibold">O√π trouver mon code ?</p>
                                <p>Votre code d'acc√®s personnel vous a √©t√© communiqu√© par votre professeur. Si vous l'avez perdu, demandez-le lui.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Message d'aide */}
                    {!searchName && !showCodeInput && (
                      <div className="bg-blue-500/20 border border-blue-400/30 rounded-lg p-4 mt-4">
                        <div className="flex items-start gap-3">
                          <span className="text-2xl">üí°</span>
                          <div className="text-white text-sm">
                            <p className="font-semibold mb-1">Comment rechercher ?</p>
                            <ul className="text-white/80 text-xs space-y-1">
                              <li>‚Ä¢ Tapez votre pr√©nom ou nom dans la barre de recherche</li>
                              <li>‚Ä¢ Cliquez sur une suggestion pour s√©lectionner rapidement</li>
                              <li>‚Ä¢ Utilisez la touche Entr√©e pour rechercher</li>
                              <li>‚Ä¢ <strong>Vous devrez ensuite entrer votre code d'acc√®s personnel</strong></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>

                  {foundPlayer && (
                    <div className="space-y-6">
                      {/* Bouton de d√©connexion */}
                      <div className="text-right">
                        <button
                          onClick={() => {
                            setFoundPlayer(null);
                            setSearchHistory([]);
                            setAccessCode('');
                            setSearchName('');
                            setPendingPlayerName('');
                            setShowCodeInput(false); // Important : r√©initialiser l'√©tat du code
                          }}
                          className="bg-red-600/80 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm transition-colors"
                        >
                          üîì Se d√©connecter
                        </button>
                      </div>
                      
                      {/* Le th√®me sera appliqu√© par useEffect au niveau principal */}
                      
                      {/* Message de f√©licitations pour draft */}
                      {showDraftCelebration && (() => {
                        const maxime = getFranchiseMaxime(foundPlayer.franchise);
                        const avatar = getFranchiseAvatar(foundPlayer.franchise);
                        
                        return (
                          <div className="bg-gradient-to-r from-yellow-400/20 via-orange-400/20 to-red-400/20 border-2 border-yellow-400/50 rounded-xl p-6 mb-6 text-center relative overflow-hidden">
                            <div className="absolute inset-0 bg-gradient-to-r from-yellow-400/10 to-orange-400/10 animate-pulse"></div>
                            <div className="relative z-10">
                              <div className="text-6xl mb-4">üéâ</div>
                              <h2 className="text-3xl font-bold text-yellow-300 mb-3">
                                F√âLICITATIONS !
                              </h2>
                              <div className="flex items-center justify-center gap-3 mb-4">
                                <span className={`text-4xl ${avatar.class}`}>{avatar.emoji}</span>
                                <span className="text-2xl font-bold text-white">{foundPlayer.franchise}</span>
                              </div>
                              <div className="text-lg text-white mb-4">
                                <p className="mb-2">üåü <strong>Tu as √©t√© draft√©{foundPlayer.name.endsWith('e') ? 'e' : ''} par les {foundPlayer.franchise} !</strong></p>
                                <p className="text-yellow-200">C'est un honneur √©norme et une grande responsabilit√©.</p>
                                <p className="text-blue-200">Tu repr√©sentes maintenant les couleurs de cette noble franchise.</p>
                                <p className="text-green-200">Tes {foundPlayer.score} points contribuent d√©sormais √† la gloire collective !</p>
                              </div>
                              <div className="text-sm text-yellow-300 italic">
                                "Avec les grands pouvoirs viennent les grandes responsabilit√©s"
                              </div>
                              <button
                                onClick={() => setShowDraftCelebration(false)}
                                className="mt-4 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 text-white px-6 py-2 rounded-full font-bold transform transition-all hover:scale-105"
                              >
                                J'accepte cette responsabilit√© ! üí™
                              </button>
                            </div>
                          </div>
                        );
                      })()}

                      {/* Inscription sacr√©e du temple de la franchise */}
                      {(() => {
                        const maxime = getFranchiseMaxime(foundPlayer.franchise);
                        if (!maxime) return null;
                        
                        return (
                          <div className="temple-inscription">
                            <div className="temple-ornament left">{maxime.ornament}</div>
                            <div className="temple-ornament right">{maxime.ornament}</div>
                            <div className="maxime-english">"{maxime.english}"</div>
                            <div className="maxime-french">"{maxime.french}"</div>
                          </div>
                        );
                      })()}
                      
                      {/* Message de bienvenue si r√©cemment draft√© */}
                      {(() => {
                        // V√©rifier si le joueur a √©t√© r√©cemment draft√© (dans les derni√®res 24h)
                        const now = new Date();
                        const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);
                        
                        const recentDraftEntry = searchHistory.find(entry => {
                          // V√©rifier si c'est une action de draft
                          if (!entry.action || !entry.action.includes('üéâ Draft√©')) return false;
                          
                          // V√©rifier si c'est r√©cent (dans les derni√®res 24h)
                          const entryDate = new Date(entry.timestamp);
                          return entryDate > oneDayAgo;
                        });
                        
                        if (recentDraftEntry) {
                          // D√©clencher les confettis - version simplifi√©e sans useEffect
                          if (window.confetti) {
                            // Explosion de confettis aux couleurs de la franchise
                            const franchiseConfettiColors = {
                              'Minotaurs': ['#dc2626', '#991b1b', '#fef3c7'],
                              'Krakens': ['#0891b2', '#0c4a6e', '#67e8f9'],
                              'Phoenix': ['#7c3aed', '#5b21b6', '#ddd6fe'],
                              'Werewolves': ['#16a34a', '#15803d', '#bbf7d0'],
                              'Non-Draft√©s': ['#6b7280', '#4b5563', '#f3f4f6']
                            };
                            
                            const colors = franchiseConfettiColors[foundPlayer.franchise] || ['#fbbf24', '#f59e0b', '#d97706'];
                            
                            // Premier tir de confettis
                            setTimeout(() => {
                              window.confetti({
                                particleCount: 150,
                                spread: 70,
                                origin: { y: 0.6 },
                                colors: colors
                              });
                            }, 100);
                            
                            // Deuxi√®me tir avec d√©lai
                            setTimeout(() => {
                              window.confetti({
                                particleCount: 100,
                                angle: 60,
                                spread: 55,
                                origin: { x: 0 },
                                colors: colors
                              });
                            }, 350);
                            
                            // Troisi√®me tir
                            setTimeout(() => {
                              window.confetti({
                                particleCount: 100,
                                angle: 120,
                                spread: 55,
                                origin: { x: 1 },
                                colors: colors
                              });
                            }, 500);
                          }
                          
                          return (
                            <div className="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border-2 border-yellow-400 rounded-xl p-6 mb-6 animate-pulse">
                              <div className="text-center">
                                <div className="text-4xl mb-3">üéâ</div>
                                <h2 className="text-2xl font-bold text-yellow-300 mb-2">
                                  F√©licitations ! Vous avez √©t√© draft√© !
                                </h2>
                                <p className="text-white text-lg">
                                  Bienvenue dans la franchise <span className="font-bold text-yellow-200">{foundPlayer.franchise}</span> !
                                </p>
                                <p className="text-white/80 mt-2">
                                  Vos points et badges ont √©t√© transf√©r√©s avec succ√®s.
                                </p>
                              </div>
                            </div>
                          );
                        }
                        return null;
                      })()}
                      
                      <div className={`bg-gradient-to-r ${franchiseColors[foundPlayer.franchise]} p-6 rounded-xl franchise-card`}>
                        <div className="text-center">
                          <h2 className="text-3xl font-bold text-white mb-2">{foundPlayer.name}</h2>
                          <div className="text-xl text-white/90 mb-4 flex items-center justify-center space-x-3">
                            <>
                              <span>Franchise:</span>
                              <div className="flex items-center space-x-2">
                                <span className={`franchise-avatar ${getFranchiseAvatar(foundPlayer.franchise).class}`}>
                                  {getFranchiseAvatar(foundPlayer.franchise).emoji}
                                </span>
                                <span className="font-bold">{foundPlayer.franchise}</span>
                              </div>
                            </>
                          </div>
                          <div className="mb-4">
                            <div className="inline-flex items-center space-x-2 bg-black/30 px-4 py-2 rounded-full">
                              <span className="text-3xl">{getBadge(foundPlayer.score).emoji}</span>
                              <span className={`text-xl font-bold ${getBadge(foundPlayer.score).color}`}>
                                {getBadge(foundPlayer.score).name}
                              </span>
                            </div>
                          </div>
                          <div className="text-5xl font-bold text-white">{foundPlayer.score} points</div>
                          
                          
                          {/* Bouton pour nouvelle recherche */}
                          <div className="mt-4">
                            <button
                              onClick={() => {
                                setFoundPlayer(null);
                                setSearchHistory([]);
                                setSearchName('');
                              }}
                              className="bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 text-white px-6 py-2 rounded-lg transition-all duration-300 flex items-center gap-2 mx-auto"
                            >
                              üîç Nouvelle recherche
                            </button>
                          </div>
                        </div>
                      </div>

                      {/* === STATISTIQUES AVANC√âES === */}
                      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        {/* Statistiques de base */}
                        <div className="theme-card p-6">
                          <h3 className="text-2xl font-bold theme-text-glow mb-4 flex items-center gap-2">
                            üìä Mes Statistiques
                          </h3>
                          <div className="grid grid-cols-2 gap-4">
                            <div className="bg-white/10 rounded-lg p-4 text-center">
                              <div className="text-2xl mb-1">üî•</div>
                              <div className="text-2xl font-bold text-orange-300">
                                {(() => {
                                  let streak = 0;
                                  const recent = searchHistory.slice().reverse();
                                  for (let entry of recent) {
                                    if (entry.points > 0) streak++;
                                    else break;
                                  }
                                  return streak;
                                })()}
                              </div>
                              <div className="text-xs text-white/70">S√©rie actuelle</div>
                            </div>
                            
                            <div className="bg-white/10 rounded-lg p-4 text-center">
                              <div className="text-2xl mb-1">üèÜ</div>
                              <div className="text-2xl font-bold text-yellow-300">
                                {(() => {
                                  let maxStreak = 0, currentStreak = 0;
                                  searchHistory.forEach(entry => {
                                    if (entry.points > 0) {
                                      currentStreak++;
                                      maxStreak = Math.max(maxStreak, currentStreak);
                                    } else {
                                      currentStreak = 0;
                                    }
                                  });
                                  return maxStreak;
                                })()}
                              </div>
                              <div className="text-xs text-white/70">Record s√©rie</div>
                            </div>

                            <div className="bg-white/10 rounded-lg p-4 text-center">
                              <div className="text-2xl mb-1">‚ö°</div>
                              <div className="text-2xl font-bold text-blue-300">
                                {searchHistory.length > 0 ? 
                                  (searchHistory.reduce((sum, entry) => sum + entry.points, 0) / searchHistory.length).toFixed(1)
                                  : '0.0'
                                }
                              </div>
                              <div className="text-xs text-white/70">Moyenne/action</div>
                            </div>

                            <div className="bg-white/10 rounded-lg p-4 text-center">
                              <div className="text-2xl mb-1">üìÖ</div>
                              <div className="text-2xl font-bold text-green-300">
                                {(() => {
                                  const last30Days = new Date();
                                  last30Days.setDate(last30Days.getDate() - 30);
                                  return searchHistory.filter(entry => 
                                    new Date(entry.timestamp) >= last30Days
                                  ).length;
                                })()}
                              </div>
                              <div className="text-xs text-white/70">Actions 30j</div>
                            </div>
                          </div>
                        </div>

                        {/* R√©partition Sport vs Acad√©mique */}
                        <div className="theme-card p-6">
                          <h3 className="text-2xl font-bold theme-text-glow mb-4 flex items-center gap-2">
                            üéØ R√©partition Points
                          </h3>
                          {(() => {
                            const sportPoints = searchHistory.filter(entry => 
                              entry.category === 'sport' && entry.points > 0
                            ).reduce((sum, entry) => sum + entry.points, 0);
                            
                            const academicPoints = searchHistory.filter(entry => 
                              entry.category === 'academic' && entry.points > 0
                            ).reduce((sum, entry) => sum + entry.points, 0);
                            
                            const total = sportPoints + academicPoints || 1;
                            const sportPercent = (sportPoints / total * 100);
                            const academicPercent = (academicPoints / total * 100);
                            
                            return (
                              <div className="space-y-4">
                                <div>
                                  <div className="flex justify-between items-center mb-2">
                                    <span className="flex items-center gap-2 text-white">
                                      üèÄ <span>Sport</span>
                                    </span>
                                    <span className="text-white font-bold">
                                      {sportPoints} pts ({sportPercent.toFixed(1)}%)
                                    </span>
                                  </div>
                                  <div className="h-3 bg-white/20 rounded-full overflow-hidden">
                                    <div 
                                      className="h-full bg-gradient-to-r from-orange-400 to-red-500 transition-all duration-1000"
                                      style={{ width: `${sportPercent}%` }}
                                    />
                                  </div>
                                </div>
                                
                                <div>
                                  <div className="flex justify-between items-center mb-2">
                                    <span className="flex items-center gap-2 text-white">
                                      üìö <span>Acad√©mique</span>
                                    </span>
                                    <span className="text-white font-bold">
                                      {academicPoints} pts ({academicPercent.toFixed(1)}%)
                                    </span>
                                  </div>
                                  <div className="h-3 bg-white/20 rounded-full overflow-hidden">
                                    <div 
                                      className="h-full bg-gradient-to-r from-blue-400 to-purple-500 transition-all duration-1000"
                                      style={{ width: `${academicPercent}%` }}
                                    />
                                  </div>
                                </div>

                                <div className="text-center text-white/80 text-sm mt-4">
                                  {sportPercent > academicPercent ? 
                                    "üèÄ Tu excelles en sport !" : 
                                    academicPercent > sportPercent ?
                                    "üìö Tu es fort en acad√©mique !" :
                                    "‚öñÔ∏è Parfaitement √©quilibr√© !"
                                  }
                                </div>
                              </div>
                            );
                          })()}
                        </div>
                      </div>

                      {/* === PROGRESSION VERS LES BADGES === */}
                      <div className="theme-card p-6">
                        <h3 className="text-2xl font-bold theme-text-glow mb-4 flex items-center gap-2">
                          üéñÔ∏è Progression des Badges
                        </h3>
                        <div className="space-y-4">
                          {(() => {
                            const currentStreak = (() => {
                              let streak = 0;
                              const recent = searchHistory.slice().reverse();
                              for (let entry of recent) {
                                if (entry.points > 0) streak++;
                                else break;
                              }
                              return streak;
                            })();

                            const progressBadges = [
                              { 
                                name: 'Hot Streak', 
                                emoji: 'üî•', 
                                current: currentStreak, 
                                target: 5,
                                description: '5 actions positives d\'affil√©e'
                              },
                              { 
                                name: 'Tsunami', 
                                emoji: 'üåä', 
                                current: currentStreak, 
                                target: 10,
                                description: '10 actions positives d\'affil√©e'
                              },
                              { 
                                name: 'Starting Five', 
                                emoji: '‚≠ê', 
                                current: foundPlayer.score, 
                                target: 50,
                                description: 'Atteindre 50 points'
                              },
                              { 
                                name: 'All-Star', 
                                emoji: 'üåü', 
                                current: foundPlayer.score, 
                                target: 100,
                                description: 'Atteindre 100 points'
                              },
                              { 
                                name: 'Marathon Runner', 
                                emoji: 'üèÉ', 
                                current: (() => {
                                  const last7Days = new Date();
                                  last7Days.setDate(last7Days.getDate() - 7);
                                  return searchHistory.filter(entry => 
                                    new Date(entry.timestamp) >= last7Days && entry.points > 0
                                  ).length;
                                })(), 
                                target: 5,
                                description: '5 actions positives en 7 jours'
                              },
                              { 
                                name: 'Captain Courage', 
                                emoji: 'ü¶æ', 
                                current: (() => {
                                  // Compter les actions d'arbitrage/table sur 3 mois
                                  const threeMonthsAgo = new Date();
                                  threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);
                                  return searchHistory.filter(h => 
                                    new Date(h.timestamp) >= threeMonthsAgo &&
                                    (h.action.toLowerCase().includes('table de marque') || 
                                     h.action.toLowerCase().includes('arbitrage'))
                                  ).length;
                                })(), 
                                target: 5,
                                description: 'Arbitrer ou tenir table de marque 5 fois en 3 mois'
                              },
                              { 
                                name: 'Clockwork', 
                                emoji: '‚è∞', 
                                current: (() => {
                                  // V√©rifier les retards sur 3 mois
                                  const threeMonthsAgo = new Date();
                                  threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);
                                  const retards = searchHistory.filter(h => 
                                    new Date(h.timestamp) >= threeMonthsAgo &&
                                    (h.action.toLowerCase().includes('retard') || 
                                     h.action.toLowerCase().includes('absence non justifi√©e'))
                                  ).length;
                                  // Si pas de retard, montrer la progression (3 mois = 90 jours)
                                  if (retards === 0 && searchHistory.length > 0) {
                                    const firstDate = new Date(searchHistory[0].timestamp);
                                    const daysSince = Math.floor((new Date() - firstDate) / (1000 * 60 * 60 * 24));
                                    return Math.min(daysSince, 90);
                                  }
                                  return 0; // Reset si retard
                                })(), 
                                target: 90,
                                description: 'Aucun retard pendant 3 mois (90 jours)',
                                special: true
                              },
                              { 
                                name: 'Christmas Magic', 
                                emoji: 'üéÑ', 
                                current: countSeasonalActions(foundPlayer.name, 'christmas'), 
                                target: 3,
                                description: '3 actions positives du 15 au 21 d√©cembre (aucune n√©gative)',
                                seasonal: true,
                                period: 'christmas',
                                blocked: hasNegativeSeasonalActions(foundPlayer.name, 'christmas')
                              }
                            ];

                            return progressBadges.map((badge, index) => {
                              const progress = Math.min((badge.current / badge.target) * 100, 100);
                              const isCompleted = badge.current >= badge.target;
                              const remaining = Math.max(badge.target - badge.current, 0);
                              
                              // V√©rifier si c'est un badge saisonnier et si on est dans la p√©riode
                              const isSeasonalActive = badge.seasonal && getCurrentSeasonalPeriod() === badge.period;
                              const isBlocked = badge.blocked;
                              
                              let seasonalClass = '';
                              if (badge.seasonal) {
                                if (isBlocked) {
                                  seasonalClass = 'bg-red-600/20 border border-red-500/50'; // Badge bloqu√© par action n√©gative
                                } else if (isSeasonalActive) {
                                  seasonalClass = 'bg-orange-500/20 border border-orange-400/50'; // P√©riode active
                                } else {
                                  seasonalClass = 'bg-gray-600/20 border border-gray-500/30'; // Hors saison
                                }
                              }
                              
                              return (
                                <div key={index} className={`p-4 rounded-lg ${
                                  isCompleted ? 'bg-green-500/20 border border-green-500/40' : 
                                  seasonalClass || 'bg-white/10'
                                }`}>
                                  <div className="flex items-center justify-between mb-2">
                                    <div className="flex items-center gap-3">
                                      <span className="text-2xl">{badge.emoji}</span>
                                      <div>
                                        <div className={`font-bold ${isCompleted ? 'text-green-300' : (isBlocked ? 'text-red-300' : 'text-white')}`}>
                                          {badge.name}
                                          {isCompleted && <span className="ml-2">‚úÖ</span>}
                                          {badge.seasonal && isBlocked && <span className="ml-2 text-red-400">üö´ BLOQU√â</span>}
                                          {badge.seasonal && !isBlocked && isSeasonalActive && <span className="ml-2 text-orange-300">üî• ACTIF</span>}
                                          {badge.seasonal && !isBlocked && !isSeasonalActive && !isCompleted && <span className="ml-2 text-gray-400">‚è≥ Hors saison</span>}
                                        </div>
                                        <div className="text-xs text-white/70">{badge.description}</div>
                                      </div>
                                    </div>
                                    <div className="text-right">
                                      <div className={`font-bold ${isCompleted ? 'text-green-300' : 'text-white'}`}>
                                        {badge.current}/{badge.target}
                                      </div>
                                      {!isCompleted && remaining > 0 && !isBlocked && (
                                        <div className="text-xs text-orange-300">
                                          Plus que {remaining} !
                                        </div>
                                      )}
                                      {isBlocked && (
                                        <div className="text-xs text-red-300">
                                          Action n√©gative d√©tect√©e !
                                        </div>
                                      )}
                                    </div>
                                  </div>
                                  
                                  <div className="h-2 bg-white/20 rounded-full overflow-hidden">
                                    <div 
                                      className={`h-full transition-all duration-1000 ${
                                        isCompleted 
                                          ? 'bg-gradient-to-r from-green-400 to-green-600' 
                                          : isBlocked
                                          ? 'bg-gradient-to-r from-red-400 to-red-600'
                                          : 'bg-gradient-to-r from-yellow-400 to-orange-500'
                                      }`}
                                      style={{ width: `${isBlocked ? 100 : progress}%` }}
                                    />
                                  </div>
                                  
                                  {!isCompleted && (
                                    <div className="mt-2 text-xs text-white/60">
                                      {isBlocked ? 'Badge bloqu√© par action n√©gative' : `${progress.toFixed(1)}% compl√©t√©`}
                                    </div>
                                  )}
                                </div>
                              );
                            });
                          })()}
                        </div>
                      </div>

                      {/* === GRAPHIQUE D'√âVOLUTION === */}
                      <div className="theme-card p-6">
                        <h3 className="text-2xl font-bold theme-text-glow mb-4 flex items-center gap-2">
                          üìà √âvolution des Points
                        </h3>
                        <div className="h-64 relative">
                          <canvas 
                            id={`evolutionChart-${foundPlayer.name.replace(/\s+/g, '')}`}
                            className="w-full h-full"
                          />
                        </div>
                        {(() => {
                          // Cr√©er le graphique avec Chart.js
                          setTimeout(() => {
                            const canvas = document.getElementById(`evolutionChart-${foundPlayer.name.replace(/\s+/g, '')}`);
                            if (!canvas) return;
                            
                            const ctx = canvas.getContext('2d');
                            
                            // Pr√©parer les donn√©es d'√©volution
                            const evolutionData = [];
                            let runningTotal = 0;
                            
                            // Trier l'historique par date et cr√©er les points d'√©volution
                            const sortedHistory = [...searchHistory].sort((a, b) => {
                              const dateA = new Date(a.timestamp);
                              const dateB = new Date(b.timestamp);
                              return dateA - dateB;
                            });
                            
                            // Commencer avec le score initial (0)
                            if (sortedHistory.length > 0) {
                              const firstDate = new Date(sortedHistory[0].timestamp);
                              evolutionData.push({
                                x: new Date(firstDate.getTime() - 86400000).toISOString(), // Jour pr√©c√©dent
                                y: 0,
                                points: 0,
                                action: 'Point de d√©part'
                              });
                            }
                            
                            sortedHistory.forEach((entry, index) => {
                              runningTotal = parseInt(entry.new_total) || (runningTotal + entry.points);
                              evolutionData.push({
                                x: entry.timestamp,
                                y: runningTotal,
                                points: entry.points,
                                action: entry.action,
                                teacher: entry.teacher_name
                              });
                            });
                            
                            // Fallback si pas d'historique
                            if (evolutionData.length === 0) {
                              evolutionData.push({
                                x: new Date().toISOString(),
                                y: foundPlayer.score,
                                points: foundPlayer.score,
                                action: 'Score actuel',
                                teacher: 'N/A'
                              });
                            }
                            
                            new Chart(ctx, {
                              type: 'line',
                              data: {
                                datasets: [{
                                  label: 'Points totaux',
                                  data: evolutionData,
                                  borderColor: 'rgba(59, 130, 246, 1)',
                                  backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                  borderWidth: 3,
                                  fill: true,
                                  tension: 0.4,
                                  pointBackgroundColor: evolutionData.map(point => 
                                    point.points > 0 ? '#10B981' : point.points < 0 ? '#EF4444' : '#6B7280'
                                  ),
                                  pointBorderColor: '#FFFFFF',
                                  pointBorderWidth: 2,
                                  pointRadius: 6,
                                  pointHoverRadius: 8
                                }]
                              },
                              options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                interaction: {
                                  intersect: false,
                                  mode: 'index'
                                },
                                plugins: {
                                  legend: {
                                    display: false
                                  },
                                  tooltip: {
                                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                    titleColor: '#FFFFFF',
                                    bodyColor: '#FFFFFF',
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    borderWidth: 1,
                                    callbacks: {
                                      title: function(context) {
                                        return new Date(context[0].parsed.x).toLocaleDateString('fr-FR');
                                      },
                                      label: function(context) {
                                        const point = evolutionData[context.dataIndex];
                                        const labels = [
                                          `Total: ${point.y} points`,
                                          `Action: ${point.action}`,
                                          `Points: ${point.points > 0 ? '+' : ''}${point.points}`
                                        ];
                                        if (point.teacher && point.teacher !== 'N/A') {
                                          labels.push(`Par: ${point.teacher}`);
                                        }
                                        return labels;
                                      }
                                    }
                                  }
                                },
                                scales: {
                                  x: {
                                    type: 'time',
                                    time: {
                                      unit: 'day',
                                      displayFormats: {
                                        day: 'DD/MM'
                                      }
                                    },
                                    grid: {
                                      color: 'rgba(255, 255, 255, 0.1)'
                                    },
                                    ticks: {
                                      color: 'rgba(255, 255, 255, 0.7)'
                                    }
                                  },
                                  y: {
                                    beginAtZero: true,
                                    grid: {
                                      color: 'rgba(255, 255, 255, 0.1)'
                                    },
                                    ticks: {
                                      color: 'rgba(255, 255, 255, 0.7)'
                                    }
                                  }
                                }
                              }
                            });
                          }, 100);
                          
                          return null;
                        })()}
                      </div>

{foundPlayer.badges && foundPlayer.badges.length > 0 && (
  <div className="mt-6 bg-white/10 backdrop-blur-sm rounded-xl p-6">
    <h4 className="text-2xl font-bold text-white mb-4 text-center">
      üèÖ Mes Badges ({foundPlayer.badges.length})
    </h4>
    <div className="flex flex-wrap gap-3 justify-center">
      {foundPlayer.badges.map((badge, index) => (
        <div key={index} className="bg-black/30 px-4 py-3 rounded-lg flex items-center gap-2 hover:bg-black/50 transition-colors">
          <span className="text-3xl">{badge.badge_emoji}</span>
          <div>
            <div className="text-white font-bold">{badge.badge_name}</div>
            <div className="text-yellow-300 text-xs">+{badge.points || 0} pts</div>
          </div>
        </div>
      ))}
    </div>
  </div>
)}
                      <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                        <h3 className="text-2xl font-bold text-white mb-6 text-center">
                          üìã Mon Historique
                        </h3>
                        <div className="space-y-3 max-h-96 overflow-y-auto">
                          {searchHistory.length > 0 ? (
                            searchHistory.map((entry, index) => (
                              <div key={index} className="bg-white/20 p-4 rounded-lg">
                                <div className="flex justify-between items-start">
                                  <div className="flex-1">
                                    <div className="font-semibold text-white mb-1">{entry.action}</div>
                                    <div className="text-sm text-white/80 mb-1">{entry.timestamp}</div>
                                    {entry.teacher_name && entry.teacher_name !== 'Anonyme' ? (
                                      <div className="inline-flex items-center gap-1 px-2 py-1 bg-white/10 rounded-full text-xs text-white/90">
                                        <span className="text-blue-300">üë®‚Äçüè´</span>
                                        <span className="font-medium">{entry.teacher_name}</span>
                                      </div>
                                    ) : entry.teacher_name === 'Syst√®me' ? (
                                      <div className="inline-flex items-center gap-1 px-2 py-1 bg-purple-500/20 rounded-full text-xs text-purple-300">
                                        <span>ü§ñ</span>
                                        <span className="font-medium">Syst√®me</span>
                                      </div>
                                    ) : (
                                      <div className="inline-flex items-center gap-1 px-2 py-1 bg-gray-500/20 rounded-full text-xs text-gray-300">
                                        <span>‚ùì</span>
                                        <span className="font-medium">Anonyme</span>
                                      </div>
                                    )}
                                  </div>
                                  <div className="text-right ml-4">
                                    <div className={`text-lg font-bold ${entry.points > 0 ? 'text-green-300' : 'text-red-300'}`}>
                                      {entry.points > 0 ? '+' : ''}{entry.points}
                                    </div>
                                    <div className="text-sm text-white/70">Total: {entry.new_total}</div>
                                  </div>
                                </div>
                              </div>
                            ))
                          ) : (
                            <p className="text-white/70 text-center">Aucun historique disponible</p>
                          )}
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          // PAGE CLASSEMENTS
          if (currentView === 'rankings') {
  
  const franchiseRankings = getFranchiseRankings();
  const playerRankings = getGeneralPlayerRankings();

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
      <div className="max-w-7xl mx-auto">
        <div className="flex justify-between items-center mb-8">
          <h1 className="text-4xl font-bold text-white">Classements</h1>
          <button
            onClick={() => setCurrentView(userType === 'teacher' ? 'teacher-dashboard' : 'student-dashboard')}
            className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
          >
            ‚Üê Retour
          </button>
        </div>

        {/* Onglets de navigation */}
        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-2 mb-8">
          <div className="flex space-x-2">
            <button
              onClick={() => setActiveTab('general')}
              className={`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg transition-colors ${
                activeTab === 'general'
                  ? 'bg-white text-purple-900 font-bold'
                  : 'text-white hover:bg-white/20'
              }`}
            >
              <span>Classements G√©n√©raux</span>
            </button>
            <button
              onClick={() => setActiveTab('mvp')}
              className={`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg transition-colors ${
                activeTab === 'mvp'
                  ? 'bg-white text-purple-900 font-bold'
                  : 'text-white hover:bg-white/20'
              }`}
            >
              <span>MVP & Records</span>
            </button>
            <button
              onClick={() => setActiveTab('franchises')}
              className={`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg transition-colors ${
                activeTab === 'franchises'
                  ? 'bg-white text-purple-900 font-bold'
                  : 'text-white hover:bg-white/20'
              }`}
            >
              <span>Stats Franchises</span>
            </button>
            <button
              onClick={() => setActiveTab('hall-of-fame')}
              className={`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg transition-colors ${
                activeTab === 'hall-of-fame'
                  ? 'bg-white text-purple-900 font-bold'
                  : 'text-white hover:bg-white/20'
              }`}
            >
              <span>Hall of Fame</span>
            </button>
          </div>
        </div>

        {/* S√©lecteur de p√©riode pour MVP et Stats */}
        {(activeTab === 'mvp' || activeTab === 'franchises') && (
          <div className="bg-white/10 backdrop-blur-sm rounded-xl p-4 mb-8">
            <div className="flex justify-center space-x-4">
              <button
                onClick={() => setSelectedPeriod('week')}
                className={`px-6 py-2 rounded-lg transition-colors ${
                  selectedPeriod === 'week'
                    ? 'bg-blue-600 text-white font-bold'
                    : 'bg-white/20 text-white hover:bg-white/30'
                }`}
              >
                Cette Semaine
              </button>
              <button
                onClick={() => setSelectedPeriod('month')}
                className={`px-6 py-2 rounded-lg transition-colors ${
                  selectedPeriod === 'month'
                    ? 'bg-blue-600 text-white font-bold'
                    : 'bg-white/20 text-white hover:bg-white/30'
                }`}
              >
                Ce Mois
              </button>
              <button
                onClick={() => setSelectedPeriod('trimester')}
                className={`px-6 py-2 rounded-lg transition-colors ${
                  selectedPeriod === 'trimester'
                    ? 'bg-blue-600 text-white font-bold'
                    : 'bg-white/20 text-white hover:bg-white/30'
                }`}
              >
                Ce Trimestre
              </button>
            </div>
          </div>
        )}

        {/* Contenu selon l'onglet actif */}
        {activeTab === 'general' && (
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            {/* Classement des Franchises */}
            <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
              <h2 className="text-2xl font-bold text-white mb-6 text-center">
                Classement des Franchises
              </h2>
              <div className="space-y-4">
                {franchiseRankings.map(({ franchise, score, rank }) => {
                  const avatar = getFranchiseAvatar(franchise);
                  return (
                    <div
                      key={franchise}
                      className={`bg-gradient-to-r ${franchiseColors[franchise]} p-4 rounded-lg flex justify-between items-center shadow-lg franchise-card`}
                    >
                      <div className="flex items-center space-x-3">
                        <span className="text-2xl font-bold text-white">#{rank}</span>
                        <span className={`franchise-avatar ${avatar.class}`}>
                          {avatar.emoji}
                        </span>
                        <span className="text-xl font-semibold text-white">{franchise}</span>
                      </div>
                      <span className="text-2xl font-bold text-white">{score} pts</span>
                    </div>
                  );
                })}
              </div>
            </div>

            {/* Classement G√©n√©ral */}
            <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
              <h2 className="text-2xl font-bold text-white mb-6 text-center">
                Classement G√©n√©ral
              </h2>
              <div className="space-y-2 max-h-80 md:max-h-96 overflow-y-auto">
                {playerRankings.map((player, index) => {
                  const badge = getBadge(player.score);
                  return (
                    <div
                      key={player.name}
                      className={`bg-gradient-to-r ${franchiseColors[player.franchise]} p-3 rounded-lg flex justify-between items-center shadow-md`}
                    >
                      <div className="flex items-center space-x-3">
                        <span className="text-lg font-bold text-white">#{index + 1}</span>
                        <span className="text-2xl">{badge.emoji}</span>
                        <div>
                          <span className="text-lg font-semibold text-white">{player.name}</span>
                          <div className="text-sm text-white/80">{player.franchise}</div>
                        </div>
                      </div>
                      <span className="text-lg font-bold text-white">{player.score} pts</span>
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        )}

        {activeTab === 'mvp' && <MVPSection period={selectedPeriod} />}
        {activeTab === 'franchises' && <FranchiseStatsSection period={selectedPeriod} />}
        {activeTab === 'hall-of-fame' && <HallOfFameSection />}
      </div>
    </div>
  );
}
          // PAGE DES BADGES
          if (currentView === 'badges') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-7xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üèÖ Collection de Badges</h1>
                    <button
                      onClick={() => setCurrentView(userType === 'teacher' ? 'teacher-dashboard' : 'student-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
                    >
                      ‚Üê Retour
                    </button>
                  </div>

                  {/* Badges Individuels */}
                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-8">
                    <h2 className="text-2xl font-bold text-white mb-6 text-center">üë§ Badges Individuels</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                      {Object.values(individualBadges).map(badge => {
                        // Compter combien de joueurs ont ce badge
                        const playersWithBadge = Object.entries(playerBadges).filter(([player, badges]) =>
                          badges?.some(b => b.id === badge.id)
                        ).map(([player]) => player);

                        return (
                          <div key={badge.id} className={`rounded-lg p-4 border-2 ${getRarityColor(badge.rarity)}`}>
                            <div className="flex items-center space-x-3 mb-3">
                              <span className="text-4xl">{badge.emoji}</span>
                              <div className="flex-1">
                                <h3 className="text-white font-bold text-lg">{badge.name}</h3>
                                <p className="text-white/70 text-sm">{badge.description}</p>
                                <p className="text-yellow-300 text-xs mt-1">+{badge.points} pts</p>
                              </div>
                            </div>
                            {playersWithBadge.length > 0 && (
                              <div className="text-white/60 text-xs mt-2 pt-2 border-t border-white/20">
                                <p>Obtenu par: {playersWithBadge.length} joueur(s)</p>
                                <p className="truncate">{playersWithBadge.slice(0, 3).join(', ')}{playersWithBadge.length > 3 ? '...' : ''}</p>
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>

                  {/* Badges Collectifs */}
                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h2 className="text-2xl font-bold text-white mb-6 text-center">üè† Badges Collectifs</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                      {Object.values(collectiveBadges).map(badge => {
                        // Compter combien de franchises ont ce badge
                        const franchisesWithBadge = Object.entries(franchiseBadges).filter(([franchise, badges]) =>
                          badges?.some(b => b.id === badge.id)
                        ).map(([franchise]) => franchise);

                        return (
                          <div key={badge.id} className={`rounded-lg p-4 border-2 ${getRarityColor(badge.rarity)}`}>
                            <div className="flex items-center space-x-3 mb-3">
                              <span className="text-4xl">{badge.emoji}</span>
                              <div className="flex-1">
                                <h3 className="text-white font-bold text-lg">{badge.name}</h3>
                                <p className="text-white/70 text-sm">{badge.description}</p>
                                <p className="text-yellow-300 text-xs mt-1">+{badge.points} pts franchise</p>
                              </div>
                            </div>
                            {franchisesWithBadge.length > 0 && (
                              <div className="text-white/60 text-xs mt-2 pt-2 border-t border-white/20">
                                <p>Obtenu par: {franchisesWithBadge.join(', ')}</p>
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
            );
          }
// PAGE DES GRADES
if (currentView === 'grades') {
  // D√©finition compl√®te de tous les grades
  const allGrades = [
    // GRADES N√âGATIFS
    { emoji: 'üóëÔ∏è', name: 'Scrub', minScore: -1000, maxScore: -50, color: 'from-red-900 to-red-700', description: 'Le pire niveau possible' },
    { emoji: 'ü™ë', name: 'Benchwarmer', minScore: -50, maxScore: -25, color: 'from-red-700 to-red-500', description: 'Clou√© sur le banc' },
    { emoji: 'üìâ', name: 'Plot', minScore: -25, maxScore: 0, color: 'from-gray-700 to-gray-500', description: 'Personnage sans importance' },
    
    // GRADES D√âBUTANTS
    { emoji: 'üë∂', name: 'Freshman', minScore: 0, maxScore: 10, color: 'from-yellow-600 to-yellow-500', description: 'Premi√®re ann√©e, apprend les bases' },
    { emoji: 'üèÄ', name: 'Rookie', minScore: 10, maxScore: 25, color: 'from-amber-600 to-amber-500', description: 'D√©butant prometteur' },
    
    // GRADES D√âVELOPPEMENT
    { emoji: 'üèÉ', name: 'Sixth Man', minScore: 25, maxScore: 50, color: 'from-green-700 to-green-600', description: 'Premier rempla√ßant de qualit√©' },
    { emoji: '‚≠ê', name: 'Starting Five', minScore: 50, maxScore: 75, color: 'from-green-600 to-green-500', description: 'Titulaire indiscutable' },
    
    // GRADES CONFIRM√âS
    { emoji: 'üíé', name: 'Franchise Player', minScore: 75, maxScore: 100, color: 'from-blue-700 to-blue-600', description: 'Pilier de l\'√©quipe' },
    { emoji: 'üåü', name: 'All-Star', minScore: 100, maxScore: 150, color: 'from-blue-600 to-blue-500', description: 'S√©lectionn√© parmi l\'√©lite' },
    
    // GRADES √âLITE
    { emoji: 'üî•', name: 'Superstar', minScore: 150, maxScore: 200, color: 'from-orange-600 to-red-500', description: 'Ph√©nom√®ne basketball' },
    { emoji: 'üèõÔ∏è', name: 'Hall of Fame', minScore: 200, maxScore: 250, color: 'from-yellow-600 to-yellow-500', description: 'L√©gende du sport' },
    
    // GRADE ULTIME
    { emoji: 'üêê', name: 'GOAT', minScore: 250, maxScore: 9999, color: 'from-purple-600 to-pink-600', description: 'Greatest Of All Time' }
  ];

  // Compter combien d'√©l√®ves ont chaque grade
  const getPlayersInGrade = (minScore, maxScore) => {
    return players.filter(p => p.score >= minScore && p.score < maxScore).length;
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
      <div className="max-w-7xl mx-auto">
        <div className="flex justify-between items-center mb-8">
          <h1 className="text-4xl font-bold text-white">üèÄ Syst√®me de Grades Basketball</h1>
          <button
            onClick={() => setCurrentView(userType === 'teacher' ? 'teacher-dashboard' : 'student-dashboard')}
            className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
          >
            ‚Üê Retour
          </button>
        </div>

        {/* Progression visuelle */}
        <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-8">
          <h2 className="text-2xl font-bold text-white mb-6 text-center">üéØ √âchelle de Progression</h2>
          <div className="relative">
            {/* Barre de progression */}
            <div className="absolute left-0 right-0 top-1/2 h-2 bg-white/20 rounded-full transform -translate-y-1/2"></div>
            
            {/* Points cl√©s */}
            <div className="relative flex justify-between mb-8">
              <div className="text-center">
                <div className="w-4 h-4 bg-red-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">-50</div>
              </div>
              <div className="text-center">
                <div className="w-4 h-4 bg-yellow-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">0</div>
              </div>
              <div className="text-center">
                <div className="w-4 h-4 bg-green-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">50</div>
              </div>
              <div className="text-center">
                <div className="w-4 h-4 bg-blue-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">100</div>
              </div>
              <div className="text-center">
                <div className="w-4 h-4 bg-orange-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">150</div>
              </div>
              <div className="text-center">
                <div className="w-4 h-4 bg-purple-500 rounded-full mb-2"></div>
                <div className="text-white text-xs">250+</div>
              </div>
            </div>
          </div>
        </div>

        {/* Liste des grades */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {allGrades.map((grade, index) => {
            const playersCount = getPlayersInGrade(grade.minScore, grade.maxScore);
            const isNegative = grade.minScore < 0;
            
            return (
              <div 
                key={index} 
                className={`bg-gradient-to-r ${grade.color} p-6 rounded-xl shadow-2xl transform hover:scale-105 transition-all duration-300`}
              >
                <div className="text-center">
                  <div className="text-6xl mb-3">{grade.emoji}</div>
                  <h3 className="text-2xl font-bold text-white mb-2">{grade.name}</h3>
                  <p className="text-white/90 mb-3">{grade.description}</p>
                  
                  <div className="bg-black/30 rounded-lg p-3 mb-3">
                    <div className="text-white font-bold">
                      {grade.maxScore === 9999 ? 
                        `${grade.minScore}+ points` : 
                        `${grade.minScore} √† ${grade.maxScore} points`
                      }
                    </div>
                  </div>
                  
                  {userType === 'teacher' && (
                    <div className="text-white/80 text-sm">
                      {playersCount > 0 ? (
                        <span className="font-bold">{playersCount} √©l√®ve{playersCount > 1 ? 's' : ''}</span>
                      ) : (
                        <span className="text-white/50">Aucun √©l√®ve</span>
                      )}
                    </div>
                  )}
                  
                  {isNegative && (
                    <div className="mt-2 text-red-200 text-xs">
                      ‚ö†Ô∏è Zone de danger
                    </div>
                  )}
                </div>
              </div>
            );
          })}
        </div>

        {/* Statistiques pour les profs */}
        {userType === 'teacher' && (
          <div className="mt-8 bg-white/10 backdrop-blur-sm rounded-xl p-6">
            <h3 className="text-2xl font-bold text-white mb-4">üìä R√©partition Actuelle</h3>
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div className="text-center">
                <div className="text-3xl font-bold text-red-400">
                  {players.filter(p => p.score < 0).length}
                </div>
                <div className="text-white/70">En difficult√©</div>
              </div>
              <div className="text-center">
                <div className="text-3xl font-bold text-yellow-400">
                  {players.filter(p => p.score >= 0 && p.score < 50).length}
                </div>
                <div className="text-white/70">D√©butants</div>
              </div>
              <div className="text-center">
                <div className="text-3xl font-bold text-green-400">
                  {players.filter(p => p.score >= 50 && p.score < 150).length}
                </div>
                <div className="text-white/70">Confirm√©s</div>
              </div>
              <div className="text-center">
                <div className="text-3xl font-bold text-purple-400">
                  {players.filter(p => p.score >= 150).length}
                </div>
                <div className="text-white/70">√âlite</div>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}


            


          // PAGE GUIDE
          if (currentView === 'guide') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üìö Guide du Basketball Manager</h1>
                    <button
                      onClick={() => setCurrentView(userType === 'teacher' ? 'teacher-dashboard' : 'student-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg transition-colors"
                    >
                      ‚Üê Retour
                    </button>
                  </div>

                  {/* Notice explicative compl√®te */}
                  <div className="bg-gradient-to-r from-blue-900/50 to-purple-900/50 backdrop-blur-sm border border-white/20 rounded-2xl p-8 shadow-2xl">
                    <div className="space-y-8 text-white/90">
                      
                      <div className="text-center mb-8">
                        <h2 className="text-3xl font-bold text-white mb-4">‚ÑπÔ∏è Guide Complet - GP</h2>
                        <p className="text-lg text-white/80">
                          Tout ce que vous devez savoir sur le syst√®me de motivation Basketball Manager
                        </p>
                      </div>

                      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        
                        {/* Section 1 */}
                        <div className="bg-white/10 p-6 rounded-xl">
                          <h3 className="text-2xl font-semibold text-yellow-300 mb-4 flex items-center gap-2">
                            üéØ Qu'est-ce que le syst√®me de points ?
                          </h3>
                          <p className="leading-relaxed">
                            Le Basketball Manager est un syst√®me de motivation et de r√©compense qui permet aux √©l√®ves de gagner des points 
                            pour leurs efforts acad√©miques et sportifs. Chaque action positive est r√©compens√©e ! 
                            Ce syst√®me encourage l'engagement, la progression et l'esprit d'√©quipe.
                          </p>
                        </div>

                        {/* Section 2 */}
                        <div className="bg-white/10 p-6 rounded-xl">
                          <h3 className="text-2xl font-semibold text-green-300 mb-4 flex items-center gap-2">
                            ‚öñÔ∏è Comment fonctionnent les points ?
                          </h3>
                          <div className="space-y-3">
                            <p className="leading-relaxed">
                              Les points sont r√©partis en <span className="font-semibold text-blue-200">üìñ Points Acad√©miques</span> (li√©s au travail scolaire, participation, progr√®s) 
                              et en <span className="font-semibold text-green-200">üèÄ Points Sportifs</span> (li√©s au comportement, effort, fair-play pendant les activit√©s sportives).
                            </p>
                            <div className="bg-yellow-500/20 border-l-4 border-yellow-400 pl-4 py-3">
                              <p className="text-yellow-200 font-medium text-sm">
                                ‚ö†Ô∏è <span className="font-semibold">Important :</span> Les √©l√®ves peuvent aussi perdre des points en cas de comportement inad√©quat 
                                ou de manquements aux r√®gles de vie scolaire et sportive.
                              </p>
                            </div>
                          </div>
                        </div>

                        {/* Section 3 */}
                        <div className="bg-white/10 p-6 rounded-xl">
                          <h3 className="text-2xl font-semibold text-cyan-300 mb-4 flex items-center gap-2">
                            üë• Qui participe au suivi ?
                          </h3>
                          <p className="leading-relaxed mb-4">
                            Toute la communaut√© √©ducative autour de votre enfant contribue √† ce syst√®me de suivi :
                          </p>
                          <div className="flex flex-wrap gap-3 mb-3">
                            <span className="bg-blue-600/30 px-4 py-2 rounded-full text-sm">üë®‚Äçüè´ Professeurs</span>
                            <span className="bg-purple-600/30 px-4 py-2 rounded-full text-sm">üëÆ‚Äç‚ôÇÔ∏è Surveillants</span>
                            <span className="bg-green-600/30 px-4 py-2 rounded-full text-sm">üèÉ‚Äç‚ôÇÔ∏è Entra√Æneurs</span>
                            <span className="bg-orange-600/30 px-4 py-2 rounded-full text-sm">üè´ √âquipe p√©dagogique</span>
                          </div>
                          <p className="text-sm text-white/70 italic">
                            Cette approche collaborative permet un suivi global et bienveillant de chaque √©l√®ve.
                          </p>
                        </div>

                        {/* Section 4 */}
                        <div className="bg-white/10 p-6 rounded-xl">
                          <h3 className="text-2xl font-semibold text-purple-300 mb-4 flex items-center gap-2">
                            üèÜ Syst√®me de Franchises
                          </h3>
                          <p className="leading-relaxed mb-4">
                            Chaque √©l√®ve appartient √† une franchise avec ses propres couleurs et th√®me :
                          </p>
                          <div className="grid grid-cols-2 gap-2 text-sm">
                            <span className="bg-red-600/30 px-3 py-2 rounded-lg text-center">üêÇ Minotaurs</span>
                            <span className="bg-blue-600/30 px-3 py-2 rounded-lg text-center">üêô Krakens</span>
                            <span className="bg-orange-600/30 px-3 py-2 rounded-lg text-center">üî• Phoenix</span>
                            <span className="bg-green-600/30 px-3 py-2 rounded-lg text-center">üê∫ Werewolves</span>
                          </div>
                          <p className="text-sm text-white/70 mt-3">
                            Les points individuels contribuent aussi aux performances de la franchise !
                          </p>
                        </div>

                      </div>

                      {/* Section large sur les badges */}
                      <div className="bg-white/10 p-6 rounded-xl">
                        <h3 className="text-2xl font-semibold text-orange-300 mb-4 flex items-center gap-2">
                          üèÖ Badges et R√©compenses
                        </h3>
                        <p className="leading-relaxed mb-4">
                          En accumulant des points, les √©l√®ves d√©bloquent diff√©rents badges et grades : 
                          <span className="font-semibold text-yellow-200"> Rookie ‚Üí Starter ‚Üí All-Star ‚Üí MVP ‚Üí Legend</span>.
                        </p>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                          <div className="bg-blue-500/20 p-3 rounded-lg">
                            <div className="font-semibold mb-1">üèÜ Badges de Performance</div>
                            <div className="text-white/80">R√©compensent l'excellence et les progr√®s</div>
                          </div>
                          <div className="bg-green-500/20 p-3 rounded-lg">
                            <div className="font-semibold mb-1">üéØ Badges d'Assiduit√©</div>
                            <div className="text-white/80">R√©compensent la r√©gularit√© et l'engagement</div>
                          </div>
                          <div className="bg-purple-500/20 p-3 rounded-lg">
                            <div className="font-semibold mb-1">üë• Badges d'√âquipe</div>
                            <div className="text-white/80">R√©compensent l'esprit d'√©quipe et l'entraide</div>
                          </div>
                        </div>
                      </div>

                      {/* Message aux parents */}
                      <div className="bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-400/30 p-6 rounded-xl">
                        <h3 className="text-2xl font-semibold text-yellow-300 mb-4 flex items-center gap-2">
                          üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Message aux Parents
                        </h3>
                        <div className="space-y-3">
                          <p className="leading-relaxed">
                            Ce syst√®me encourage la motivation intrins√®que de votre enfant en valorisant ses efforts quotidiens. 
                            Vous pouvez consulter ses progr√®s dans la section "Mon Score" pour suivre son √©volution acad√©mique et sportive.
                          </p>
                          <div className="bg-green-500/20 border-l-4 border-green-400 pl-4 py-3">
                            <p className="font-medium text-green-200">
                              üí° <span className="font-semibold">Conseil :</span> Encouragez votre enfant √† viser les prochains objectifs et f√©licitez-le pour ses efforts, 
                              m√™me les plus petits ! La r√©gularit√© est plus importante que la performance ponctuelle.
                            </p>
                          </div>
                          <div className="text-sm text-white/70 mt-4">
                            <p><span className="font-semibold">Pour toute question :</span> N'h√©sitez pas √† contacter l'√©quipe p√©dagogique pour un suivi personnalis√© de votre enfant.</p>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // Return principal avec le modal d'historique et notifications
          return (
            <>
              {/* Syst√®me de notifications */}
              <NotificationSystem notifications={notifications} />
              
              {/* Navigation mobile fixe en bas */}
              <div className="mobile-nav">
                <button
                  onClick={() => setCurrentView('home')}
                  className={`mobile-nav-button ${currentView === 'home' ? 'active' : ''}`}
                >
                  <span className="mobile-nav-icon">üè†</span>
                  <span className="mobile-nav-text">Accueil</span>
                </button>
                
                {userType === 'student' && (
                  <>
                    <button
                      onClick={() => setCurrentView('student-search')}
                      className={`mobile-nav-button ${currentView === 'student-search' ? 'active' : ''}`}
                    >
                      <span className="mobile-nav-icon">üîç</span>
                      <span className="mobile-nav-text">Score</span>
                    </button>
                    <button
                      onClick={() => setCurrentView('student-dashboard')}
                      className={`mobile-nav-button ${currentView === 'student-dashboard' ? 'active' : ''}`}
                    >
                      <span className="mobile-nav-icon">üèÄ</span>
                      <span className="mobile-nav-text">Franchises</span>
                    </button>
                  </>
                )}
                
                {userType === 'teacher' && (
                  <>
                    <button
                      onClick={() => setCurrentView('teacher-players')}
                      className={`mobile-nav-button ${currentView === 'teacher-players' ? 'active' : ''}`}
                    >
                      <span className="mobile-nav-icon">üë•</span>
                      <span className="mobile-nav-text">√âl√®ves</span>
                    </button>
                    <button
                      onClick={() => setCurrentView('teacher-dashboard')}
                      className={`mobile-nav-button ${currentView === 'teacher-dashboard' ? 'active' : ''}`}
                    >
                      <span className="mobile-nav-icon">‚öôÔ∏è</span>
                      <span className="mobile-nav-text">Gestion</span>
                    </button>
                  </>
                )}
                
                <button
                  onClick={() => setCurrentView('rankings')}
                  className={`mobile-nav-button ${currentView === 'rankings' ? 'active' : ''}`}
                >
                  <span className="mobile-nav-icon">üèÜ</span>
                  <span className="mobile-nav-text">Classements</span>
                </button>
                
                {userType && (
                  <button
                    onClick={() => {
                      setUserType(null);
                      setCurrentView('home');
                      setSelectedFranchiseView(null);
                    }}
                    className="mobile-nav-button"
                  >
                    <span className="mobile-nav-icon">üö™</span>
                    <span className="mobile-nav-text">Quitter</span>
                  </button>
                )}
              </div>
              
              {selectedPlayerHistory && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 modal-backdrop">
                  <div className="bg-white rounded-xl p-4 md:p-6 max-w-md w-full max-h-[85vh] md:max-h-96 overflow-y-auto modal-content">
                    <div className="flex justify-between items-center mb-4">
                      <h3 className="text-xl font-bold">Historique de {selectedPlayerHistory}</h3>
                      <button
                        onClick={() => setSelectedPlayerHistory(null)}
                        className="text-gray-500 hover:text-gray-700 text-xl"
                      >
                        √ó
                      </button>
                    </div>
                    <div className="space-y-2">
                      {playerHistory.length > 0 ? (
                        playerHistory.map((entry, index) => (
                          <div key={index} className="border-l-4 border-blue-500 pl-3 py-2">
                            <div className="flex justify-between items-start mb-1">
                              <div className="font-semibold flex-1">{entry.action}</div>
                              <div className={`text-sm font-bold ml-2 ${entry.points > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                {entry.points > 0 ? '+' : ''}{entry.points} pts
                              </div>
                            </div>
                            <div className="text-xs text-gray-500 mb-2">
                              {entry.timestamp} ‚Ä¢ Total: {entry.new_total} pts
                            </div>
                            {entry.teacher_name && entry.teacher_name !== 'Anonyme' ? (
                              <div className="inline-flex items-center gap-1 px-2 py-1 bg-blue-50 border border-blue-200 rounded-full text-xs text-blue-700">
                                <span>üë®‚Äçüè´</span>
                                <span className="font-medium">{entry.teacher_name}</span>
                              </div>
                            ) : entry.teacher_name === 'Syst√®me' ? (
                              <div className="inline-flex items-center gap-1 px-2 py-1 bg-purple-50 border border-purple-200 rounded-full text-xs text-purple-700">
                                <span>ü§ñ</span>
                                <span className="font-medium">Syst√®me</span>
                              </div>
                            ) : (
                              <div className="inline-flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-full text-xs text-gray-600">
                                <span>‚ùì</span>
                                <span className="font-medium">Anonyme</span>
                              </div>
                            )}
                          </div>
                        ))
                      ) : (
                        <p className="text-gray-500 text-center">Aucun historique disponible</p>
                      )}
                    </div>
                  </div>
                </div>
              )}
            </>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
